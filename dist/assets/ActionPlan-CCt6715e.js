import{c as Xe,r as x,ab as ke,O as e,$ as be,X as We,V as Ge,W as Ke,ad as y,ae as C,af as Ue,d as E,a1 as Be,S as Ve,aa as _e,ag as Ze,ah as we,ai as ye,aj as qe,ak as He}from"./index-BSRzldBn.js";import{C as je}from"./calendar-CVMhEwni.js";import{Z as Je,a as Qe}from"./zoom-out-BmoA93GM.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=Xe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),et=({isOpen:$,onClose:A,onSave:B,onDelete:W,initialData:p,defaultStartDate:w})=>{const[m,N]=x.useState({id:"",name:"",description:"",owner:"",group:"",startDate:"",endDate:"",status:"Not Started",progress:0});if(x.useEffect(()=>{if($)if(p)N(p);else{const h=new Date().toISOString().split("T")[0],z=w||h,F=new Date(new Date(z).getTime()+7*24*60*60*1e3).toISOString().split("T")[0];N({id:ke(),name:"",description:"",owner:"",group:"",startDate:z,endDate:F,status:"Not Started",progress:0})}},[$,p,w]),!$)return null;const P=m.status==="Completed"?"bg-emerald-50 text-emerald-700 border-emerald-200":m.status==="In Progress"?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-100 text-gray-700 border-gray-200",V=h=>{h.preventDefault(),B(m),A()};return e.jsx("div",{className:"fixed inset-0 z-[70] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:A,children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-indigo-500 to-blue-500 text-white shadow-md",children:e.jsx(be,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg leading-6 font-semibold text-gray-900",id:"modal-title",children:p?"Edit Action Item":"New Action Item"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Define clear, owned actions that support your A3 plan."})]})]}),e.jsx("button",{onClick:A,className:"ml-4 rounded-full p-1.5 text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition",children:e.jsx(We,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mb-4 flex items-start gap-2 rounded-md border border-indigo-50 bg-indigo-50/80 px-3 py-2 text-xs text-indigo-800",children:[e.jsx(be,{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-indigo-500"}),e.jsx("p",{children:"Use this card to break the A3 into specific tasks with owners, timing, and progress."})]}),e.jsxs("form",{id:"action-form",onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-gray-50/60 p-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Task overview"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Name the action item and describe what needs to be done."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mt-2 block text-sm font-medium text-gray-700",children:"Task Name"}),e.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.name,onChange:h=>N({...m,name:h.target.value}),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.description||"",onChange:h=>N({...m,description:h.target.value})})]})]}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Ownership & grouping"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Assign who is responsible and how this task is grouped."})]}),m.group&&e.jsx("span",{className:"hidden sm:inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-medium text-gray-600",children:m.group})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner"}),e.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.owner,onChange:h=>N({...m,owner:h.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Group"}),e.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.group||"",onChange:h=>N({...m,group:h.target.value})})]})]})]}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Status & progress"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Track how far this action has moved and what state it is in."})]}),e.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium ${P}`,children:m.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.status,onChange:h=>N({...m,status:h.target.value}),children:[e.jsx("option",{children:"Not Started"}),e.jsx("option",{children:"In Progress"}),e.jsx("option",{children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Progress: ",m.progress,"%"]}),e.jsx("input",{type:"range",min:"0",max:"100",step:"10",className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:m.progress,onChange:h=>N({...m,progress:parseInt(h.target.value)})})]})]})]}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Timeline"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Set start and end dates so the team can follow up on time."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{type:"date",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.startDate,onChange:h=>N({...m,startDate:h.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{type:"date",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:m.endDate,onChange:h=>N({...m,endDate:h.target.value})})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 flex flex-col sm:flex-row-reverse justify-between items-center gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row-reverse w-full sm:w-auto",children:[e.jsx("button",{type:"submit",form:"action-form",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Save"}),e.jsx("button",{type:"button",onClick:A,className:"mt-3 sm:mt-0 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]}),p&&W&&e.jsx("button",{type:"button",onClick:()=>{confirm("Are you sure you want to delete this task?")&&(W(p.id),A())},className:"mt-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-100 text-base font-medium text-red-700 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Delete"})]})]})]})})},tt=40,Ne=()=>[],nt=()=>{const{id:$}=Ge(),{a3Cases:A,updateA3Case:B,selectedModel:W}=Ke(),p=A.find(r=>r.id===$),[w,m]=x.useState(Ne()),[N,P]=x.useState({start:y(new Date),end:y(C(new Date,90))}),[V,h]=x.useState(!1),[z,F]=x.useState(null),[De,se]=x.useState(void 0),[G,Se]=x.useState({}),[K,re]=x.useState(1),[f,Ie]=x.useState("week"),[ae,ne]=x.useState(!1),[oe,_]=x.useState(null),[ie,Ce]=x.useState(256),[le,de]=x.useState(!1),[ce,Te]=x.useState(0),[ue,Me]=x.useState(256),[Y,me]=x.useState(null),[O,ge]=x.useState(null),[xe,Ee]=x.useState(0),[T,he]=x.useState(null);x.useEffect(()=>{p&&(p.actionPlanTasks&&p.actionPlanTasks.length>0?m(p.actionPlanTasks):m(Ne()))},[p]),x.useEffect(()=>{if(!w.length)return;let r=null,s=null;w.forEach(a=>{const n=new Date(a.startDate),t=new Date(a.endDate);isNaN(n.getTime())||(!r||n<r)&&(r=n),isNaN(t.getTime())||(!s||t>s)&&(s=t)}),!(!r||!s)&&P(a=>{const n=new Date(a.start),t=new Date(a.end);let o=a.start,i=a.end;return(isNaN(n.getTime())||r<n)&&(o=y(r)),(isNaN(t.getTime())||s>t)&&(i=y(s)),o===a.start&&i===a.end?a:{start:o,end:i}})},[w]),x.useEffect(()=>{if(!le)return;const r=a=>{const n=a.clientX-ce;let t=ue+n;t<200&&(t=200),t>480&&(t=480),Ce(t)},s=()=>{de(!1)};return window.addEventListener("mousemove",r),window.addEventListener("mouseup",s),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)}},[le,ce,ue]);const R=r=>{p&&B({...p,actionPlanTasks:r})},Ae=x.useMemo(()=>{const r={},s=[];w.forEach(t=>{t.group?(r[t.group]||(r[t.group]=[]),r[t.group].push(t)):s.push(t)});const a=Object.keys(r),n=[];return s.forEach(t=>n.push({type:"task",task:t,id:t.id})),a.forEach(t=>{n.push({type:"group",name:t,id:`group-${t}`}),G[t]!==!1&&r[t].forEach(o=>n.push({type:"task",task:o,id:o.id}))}),n},[w,G]),Pe=r=>{Se(s=>({...s,[r]:!s[r]}))},D=(f==="month"?100:f==="week"?60:tt)*K,c=x.useMemo(()=>{const r=new Date(N.start),s=new Date(N.end);if(isNaN(r.getTime())||isNaN(s.getTime())||r>s)return[];const a=[];let n=new Date(r);if(f==="day")for(;n<=s;)Ue(n)||a.push({date:new Date(n),label:n.getDate().toString(),fullLabel:y(n),id:y(n)}),n=C(n,1);else if(f==="week"){let t=new Date(n);const o=t.getDay(),i=o===0?6:o-1;for(t.setDate(t.getDate()-i);t<=s;){const g=`${t.toLocaleString("default",{month:"short"})} ${t.getDate()}`;a.push({date:new Date(t),label:g,fullLabel:`Week of ${y(t)}`,id:y(t)}),t=C(t,7)}}else if(f==="month"){let t=new Date(n);for(t.setDate(1);t<=s;)a.push({date:new Date(t),label:t.toLocaleString("default",{month:"short"}),fullLabel:`${t.toLocaleString("default",{month:"long"})} ${t.getFullYear()}`,id:`${t.getFullYear()}-${t.getMonth()}`}),t=new Date(t.getFullYear(),t.getMonth()+1,1)}return a},[N,f]),Le=r=>{const s=new Date(r.startDate),a=new Date(r.endDate);let n=-1,t=-1;f==="day"?(n=c.findIndex(d=>d.id===r.startDate),t=c.findIndex(d=>d.id===r.endDate)):f==="week"?(n=c.findIndex(d=>{const v=d.date,b=C(v,6);return s>=v&&s<=b}),t=c.findIndex(d=>{const v=d.date,b=C(v,6);return a>=v&&a<=b})):f==="month"&&(n=c.findIndex(d=>d.date.getMonth()===s.getMonth()&&d.date.getFullYear()===s.getFullYear()),t=c.findIndex(d=>d.date.getMonth()===a.getMonth()&&d.date.getFullYear()===a.getFullYear()));const o=c[0],i=c[c.length-1];if(!o||!i)return null;const g=o.date.getTime();let u=i.date.getTime();if(f==="week"&&(u=C(i.date,6).getTime()),f==="month"&&(u=new Date(i.date.getFullYear(),i.date.getMonth()+1,0).getTime()),a.getTime()<g||s.getTime()>u)return null;if(n===-1&&(s.getTime()<g?n=0:(n=c.findIndex(d=>d.date>=s),n===-1&&(n=0))),t===-1){if(a.getTime()>u)t=c.length-1;else for(let d=c.length-1;d>=0;d--)if(c[d].date<=a){t=d;break}}if(n===-1||t===-1||n>t)return null;const k=n*D,j=(t-n+1)*D;return{left:k,width:j}},Ye=()=>{F(null),se(void 0),h(!0)},Z=r=>{F(null),se(r),h(!0)},q=(r,s)=>{r.stopPropagation(),F(s),h(!0)},$e=r=>{let s;z?s=w.map(a=>a.id===r.id?r:a):s=[...w,r],m(s),R(s)},ze=r=>{const s=w.filter(a=>a.id!==r);m(s),R(s)},pe=r=>{Ie(r)},Fe=async()=>{var n,t,o;if(!p)return;const r=p.problemStatement||"",s=p.dataAnalysisObservations||"",a=p.rootCause||"";if(!r.trim()||!s.trim()||!a.trim()){_("To generate an action plan, fill in Problem Statement, Key Observations from Data, and Identified Root Cause.");return}ne(!0),_(null);try{const g=[{role:"system",content:`You are an expert A3 Problem Solving coach.

You will receive:
- A3 Problem Statement
- Key observations from data analysis
- Identified root cause

Your task is to propose a practical, time-phased action plan that addresses the root cause and improves the problem.

Always respond in English, even if the user's inputs are in another language.

Use ${y(new Date)} as today's date when planning the timeline.

Return JSON ONLY with this structure:
{
  "tasks": [
    {
      "name": "short action title",
      "description": "detailed what/how so a team can execute",
      "owner": "role or function (e.g. Production Supervisor)",
      "group": "theme or workstream name",
      "startDate": "YYYY-MM-DD",
      "endDate": "YYYY-MM-DD",
      "status": "Not Started" | "In Progress" | "Completed",
      "progress": number
    }
  ]
}`},{role:"user",content:`Problem Statement:
${r}

Key Observations from Data:
${s}

Identified Root Cause:
${a}`}],u=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:W,messages:g,stream:!1})});if(!u.ok)throw new Error("Failed to generate action plan");let j=((o=(t=(n=(await u.json()).choices)==null?void 0:n[0])==null?void 0:t.message)==null?void 0:o.content)||"";j=j.replace(/```json/gi,"").replace(/```/g,"").trim();let d;try{d=JSON.parse(j)}catch{throw new Error("Invalid AI response format")}const v=Array.isArray(d==null?void 0:d.tasks)?d.tasks:Array.isArray(d)?d:[];if(!Array.isArray(v)||v.length===0)throw new Error("AI did not return any tasks");const b=v.map((l,M)=>{const I=typeof l.name=="string"&&l.name.trim()?l.name.trim():`Action ${M+1}`,L=typeof l.description=="string"?l.description.trim():"",X=typeof l.owner=="string"?l.owner.trim():p.owner||"",Re=typeof l.group=="string"&&l.group.trim()?l.group.trim():void 0,fe=/^\d{4}-\d{2}-\d{2}$/;let U;if(typeof l.startDate=="string"&&fe.test(l.startDate.trim()))U=l.startDate.trim();else{const te=C(new Date,M*7);U=y(te)}let J;if(typeof l.endDate=="string"&&fe.test(l.endDate.trim()))J=l.endDate.trim();else{const te=C(new Date(U),7);J=y(te)}let Q="Not Started";(l.status==="In Progress"||l.status==="Completed")&&(Q=l.status);let ee=0;return typeof l.progress=="number"&&l.progress>=0&&l.progress<=100?ee=Math.round(l.progress):Q==="Completed"&&(ee=100),{id:ke(),name:I,description:L,owner:X,group:Re,startDate:U,endDate:J,status:Q,progress:ee}}),S=[...w,...b];m(S),R(S)}catch(i){_((i==null?void 0:i.message)||"Failed to generate action plan. Please try again.")}finally{ne(!1)}},Oe=r=>{const{source:s,destination:a}=r;if(!a||s.droppableId===a.droppableId&&s.index===a.index)return;const n={ungrouped:[]},t=w.filter(b=>!b.group);n.ungrouped=[...t];const o=w.filter(b=>!!b.group).reduce((b,S)=>{const l=S.group;return b[l]||(b[l]=[]),b[l].push(S),b},{});Object.assign(n,o);const i=s.droppableId==="ungrouped"?"ungrouped":s.droppableId.replace("group-",""),g=a.droppableId==="ungrouped"?"ungrouped":a.droppableId.replace("group-",""),u=n[i],k=n[g];if(!u||!k)return;const[j]=u.splice(s.index,1);i!==g&&(g==="ungrouped"?j.group=void 0:j.group=g),k.splice(a.index,0,j);const d=Object.keys(n).filter(b=>b!=="ungrouped");let v=[...n.ungrouped];d.forEach(b=>{v=[...v,...n[b]]}),m(v),R(v)},H=(r,s,a)=>{r.stopPropagation(),r.preventDefault(),me(s.id),ge(a),Ee(r.clientX),he({...s})};return x.useEffect(()=>{const r=a=>{if(!Y||!O||!T)return;const n=a.clientX-xe,t=Math.round(n/D);if(t===0)return;const o=w.map(i=>{if(i.id!==Y)return i;let g=-1,u=-1;if(f==="day")g=c.findIndex(l=>l.id===T.startDate),u=c.findIndex(l=>l.id===T.endDate);else if(f==="week"){const l=new Date(T.startDate),M=new Date(T.endDate);g=c.findIndex(I=>{const L=I.date,X=C(L,6);return l>=L&&l<=X}),u=c.findIndex(I=>{const L=I.date,X=C(L,6);return M>=L&&M<=X})}else if(f==="month"){const l=new Date(T.startDate),M=new Date(T.endDate);g=c.findIndex(I=>I.date.getMonth()===l.getMonth()&&I.date.getFullYear()===l.getFullYear()),u=c.findIndex(I=>I.date.getMonth()===M.getMonth()&&I.date.getFullYear()===M.getFullYear())}if(g===-1||u===-1)return i;let k=g,j=u;O==="move"?(k=g+t,j=u+t):O==="resize-left"?(k=g+t,k>j&&(k=j)):O==="resize-right"&&(j=u+t,j<k&&(j=k)),k<0&&(k=0),j>=c.length&&(j=c.length-1);let d="",v="";const b=c[k],S=c[j];if(!b||!S)return i;if(f==="day")d=b.id,v=S.id;else if(f==="week")d=y(b.date),v=y(C(S.date,6));else if(f==="month"){d=y(b.date);const l=new Date(S.date.getFullYear(),S.date.getMonth()+1,0);v=y(l)}return{...i,startDate:d,endDate:v}});m(o),R(o)},s=()=>{Y&&(me(null),ge(null),he(null))};return Y&&(window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)}},[Y,O,xe,T,w,c,D,f]),e.jsxs("div",{className:"flex flex-col h-full bg-white shadow border border-gray-200 overflow-auto",children:[e.jsxs("div",{className:"flex justify-start gap-4 items-center p-4 border-b border-gray-200 bg-white z-20 sticky left-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-md p-1",children:[e.jsx("button",{onClick:()=>pe("month"),className:E("px-3 py-1 text-xs font-medium rounded transition-all",f==="month"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700 hover:bg-white/50"),children:"Month"}),e.jsx("button",{onClick:()=>pe("week"),className:E("px-3 py-1 text-xs font-medium rounded transition-all",f==="week"?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700 hover:bg-white/50"),children:"Week"})]}),e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-md p-1",children:[e.jsxs("div",{className:"hidden sm:flex items-center space-x-2 px-2",children:[e.jsx("input",{type:"date",value:N.start,onChange:r=>P(s=>({...s,start:r.target.value})),className:"text-xs bg-transparent border-none focus:ring-0 p-0 w-24 text-center font-medium text-gray-700 cursor-pointer"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:N.end,onChange:r=>P(s=>({...s,end:r.target.value})),className:"text-xs bg-transparent border-none focus:ring-0 p-0 w-24 text-center font-medium text-gray-700 cursor-pointer"})]}),e.jsxs("div",{className:"flex sm:hidden items-center space-x-1 px-1",children:[e.jsxs("label",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-md bg-white text-gray-700 shadow-sm border border-gray-200",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:N.start,onChange:r=>P(s=>({...s,start:r.target.value})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsxs("label",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-md bg-white text-gray-700 shadow-sm border border-gray-200",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:N.end,onChange:r=>P(s=>({...s,end:r.target.value})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center bg-gray-100 rounded-md p-1",children:[e.jsx("button",{onClick:()=>re(Math.max(.5,K-.25)),className:"p-1 hover:bg-white rounded shadow-sm",children:e.jsx(Je,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("span",{className:"text-xs text-gray-500 w-8 text-center",children:[Math.round(K*100),"%"]}),e.jsx("button",{onClick:()=>re(Math.min(2,K+.25)),className:"p-1 hover:bg-white rounded shadow-sm",children:e.jsx(Qe,{className:"w-4 h-4 text-gray-600"})})]}),e.jsx("button",{type:"button",onClick:Fe,disabled:ae||!p||!p.problemStatement||!p.dataAnalysisObservations||!p.rootCause,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:ae?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"animate-spin -ml-0.5 mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"AI planning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"-ml-0.5 mr-0 sm:mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"AI Action Plan"})]})})]})]}),oe&&e.jsx("div",{className:"px-4 pt-2 text-xs text-red-600",children:oe}),e.jsx("div",{className:"flex-1 relative select-none",children:e.jsxs("div",{className:"flex min-w-max",children:[e.jsxs("div",{className:"sticky left-0 z-40 bg-white border-r border-gray-200 shadow-sm flex-shrink-0 relative",style:{width:ie},children:[e.jsxs("div",{className:"h-[60px] border-b border-gray-200 bg-gray-50 flex items-center justify-between px-4 font-semibold text-xs text-gray-500 uppercase tracking-wider sticky top-0 z-30",children:[e.jsx("span",{children:"Task Details"}),e.jsx("button",{onClick:Ye,className:"p-1.5 rounded-full bg-blue-600 text-white hover:bg-blue-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500",title:"Add Task",children:e.jsx(_e,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"absolute top-0 right-0 h-full w-1.5 cursor-col-resize bg-transparent hover:bg-gray-200",onMouseDown:r=>{r.preventDefault(),de(!0),Te(r.clientX),Me(ie)}}),e.jsx(Ze,{onDragEnd:Oe,children:(()=>{const r={ungrouped:[]},s=w.filter(t=>!t.group);r.ungrouped=[...s];const a=w.filter(t=>!!t.group).reduce((t,o)=>{const i=o.group;return t[i]||(t[i]=[]),t[i].push(o),t},{}),n=Object.keys(a);return e.jsxs(e.Fragment,{children:[e.jsx(we,{droppableId:"ungrouped",children:t=>e.jsxs("div",{ref:t.innerRef,...t.droppableProps,children:[r.ungrouped.map((o,i)=>e.jsx(ye,{draggableId:o.id,index:i,children:g=>e.jsxs("div",{ref:g.innerRef,...g.draggableProps,className:"h-[48px] border-b border-gray-100 flex items-center px-4 hover:bg-gray-50 group cursor-pointer bg-white",onDoubleClick:u=>q(u,o),title:o.description,children:[e.jsx("div",{...g.dragHandleProps,className:"mr-2 text-gray-400 cursor-grab active:cursor-grabbing hover:text-gray-600",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:o.name||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsxs("span",{className:"text-[11px] text-gray-500",children:[Math.round(o.progress),"%"]}),e.jsx("div",{className:E("w-2 h-2 rounded-full flex-shrink-0",o.status==="Completed"?"bg-green-500":o.status==="In Progress"?"bg-blue-500":"bg-gray-300")})]})]}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:o.owner})]})]})},o.id)),t.placeholder]})}),n.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"h-[32px] border-b border-gray-100 flex items-center px-4 bg-gray-100 hover:bg-gray-200 cursor-pointer",onClick:()=>Pe(t),children:[G[t]!==!1?e.jsx(qe,{className:"w-3 h-3 mr-2 text-gray-600"}):e.jsx(He,{className:"w-3 h-3 mr-2 text-gray-600"}),e.jsx("span",{className:"text-xs font-bold text-blue-700 uppercase tracking-wider",children:t})]}),G[t]!==!1&&e.jsx(we,{droppableId:`group-${t}`,children:o=>e.jsxs("div",{ref:o.innerRef,...o.droppableProps,children:[a[t].map((i,g)=>e.jsx(ye,{draggableId:i.id,index:g,children:u=>e.jsxs("div",{ref:u.innerRef,...u.draggableProps,className:"h-[48px] border-b border-gray-100 flex items-center px-4 hover:bg-gray-50 group cursor-pointer bg-white",onDoubleClick:k=>q(k,i),title:i.description,children:[e.jsx("div",{...u.dragHandleProps,className:"mr-2 text-gray-400 cursor-grab active:cursor-grabbing hover:text-gray-600",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:i.name||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsxs("span",{className:"text-[11px] text-gray-500",children:[Math.round(i.progress),"%"]}),e.jsx("div",{className:E("w-2 h-2 rounded-full flex-shrink-0",i.status==="Completed"?"bg-green-500":i.status==="In Progress"?"bg-blue-500":"bg-gray-300")})]})]}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:i.owner})]})]})},i.id)),o.placeholder]})})]},t))]})})()}),Array.from({length:Math.max(0,10-w.length)}).map((r,s)=>e.jsx("div",{className:"h-[48px] border-b border-gray-50 bg-gray-50/10"},`empty-${s}`))]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex h-[60px] border-b border-gray-200 bg-gray-50 sticky top-0 z-20",children:c.map((r,s)=>{const a=f==="day"?y(r.date)===y(new Date):!1;return e.jsxs("div",{className:E("flex-shrink-0 border-r border-gray-200 flex flex-col items-center justify-center overflow-hidden px-0.5",a?"bg-blue-50":""),style:{width:D},title:r.fullLabel,children:[e.jsx("span",{className:E("font-semibold text-gray-700 whitespace-nowrap",D<45?"text-[10px]":"text-xs"),children:D<40&&f==="week"?`${r.date.getMonth()+1}/${r.date.getDate()}`:r.label}),f==="day"&&D>=30&&e.jsx("span",{className:"text-gray-400 text-[10px]",children:r.date.toLocaleDateString("en-US",{weekday:"narrow"})})]},s)})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex pointer-events-none",children:c.map((r,s)=>e.jsx("div",{className:E("flex-shrink-0 border-r border-gray-100 h-full"),style:{width:D}},s))}),Ae.map(r=>{if(r.type==="group")return e.jsx("div",{className:"h-[32px] border-b border-gray-100 bg-gray-50/50"},r.id);const s=r.task,a=Le(s);if(!a)return e.jsx("div",{className:"h-[48px] border-b border-gray-100 relative group",children:e.jsx("div",{className:"absolute inset-0 z-0",onClick:o=>{const i=o.currentTarget.getBoundingClientRect(),g=o.clientX-i.left,u=Math.floor(g/D);u>=0&&u<c.length&&Z(y(c[u].date))}})},s.id);const{left:n,width:t}=a;return e.jsxs("div",{className:"h-[48px] border-b border-gray-100 relative group",children:[e.jsx("div",{className:"absolute inset-0 z-0",onClick:o=>{const i=o.currentTarget.getBoundingClientRect(),g=o.clientX-i.left,u=Math.floor(g/D);u>=0&&u<c.length&&Z(y(c[u].date))}}),e.jsxs("div",{className:E("absolute top-2.5 h-7 rounded-md shadow-sm border border-opacity-20 flex items-center px-2 text-xs text-white overflow-hidden cursor-move z-10 transition-colors",s.status==="Completed"?"bg-green-500 border-green-700":s.status==="In Progress"?"bg-blue-500 border-blue-700":"bg-gray-400 border-gray-600",Y===s.id?"ring-2 ring-offset-1 ring-blue-400 opacity-90":"hover:brightness-110"),style:{left:Math.max(0,n),width:Math.max(D,t)},onMouseDown:o=>H(o,s,"move"),onDoubleClick:o=>q(o,s),children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-black/10",onMouseDown:o=>H(o,s,"resize-left")}),e.jsx("span",{className:"truncate drop-shadow-md font-medium pl-1",children:s.name}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize hover:bg-black/10",onMouseDown:o=>H(o,s,"resize-right")})]})]},s.id)}),Array.from({length:Math.max(0,10-w.length)}).map((r,s)=>e.jsx("div",{className:"h-[48px] border-b border-gray-50 bg-gray-50/10 relative",children:e.jsx("div",{className:"absolute inset-0 z-0",onClick:a=>{const n=a.currentTarget.getBoundingClientRect(),t=a.clientX-n.left,o=Math.floor(t/D);o>=0&&o<c.length&&Z(y(c[o].date))}})},`empty-row-${s}`))]})]})]})}),e.jsx(et,{isOpen:V,onClose:()=>h(!1),onSave:$e,onDelete:ze,initialData:z,defaultStartDate:De})]})};export{nt as default};
