import{c as Se,r as h,ah as Ce,O as e,d as S,S as Ie,a6 as Ue,X as Be,at as _e,a5 as re,$ as Je,a1 as Ve,ag as j,ai as E,au as qe,av as ve,aw as He,ax as Ze,a9 as Qe,ay as et,az as tt,aA as je,aB as Ne,aC as st}from"./index-D53RQmFX.js";import{C as ye}from"./clock-CU07uLn2.js";import{C as at}from"./check-circle-2--U_2IYn-.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=Se("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=Se("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),nt=({isOpen:Y,onClose:J,onSave:V,onDelete:X,initialData:p,defaultStartDate:v})=>{const[T,M]=h.useState(!1),[g,C]=h.useState({id:"",name:"",description:"",owner:"",group:"",startDate:"",endDate:"",status:"Not Started",progress:0});h.useEffect(()=>{if(Y)if(M(!1),p)C(p);else{const i=new Date().toISOString().split("T")[0],G=v||i,K=new Date(new Date(G).getTime()+7*24*60*60*1e3).toISOString().split("T")[0];C({id:Ce(),name:"",description:"",owner:"",group:"",startDate:G,endDate:K,status:"Not Started",progress:0})}},[Y,p,v]);const A=()=>{M(!0),setTimeout(()=>{J(),M(!1)},200)},W=i=>{i.preventDefault(),V(g),A()};return!Y&&!T?null:e.jsxs("div",{className:"fixed inset-0 z-[100] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:S("fixed inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity duration-300 ease-out",T?"opacity-0":"opacity-100"),onClick:A}),e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:S("inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-2xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full border border-white/20 ring-1 ring-black/5",T?"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95":"opacity-100 translate-y-0 sm:scale-100 duration-300 ease-out"),children:[e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-white px-6 py-5 border-b border-slate-100 flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-violet-600 text-white flex items-center justify-center shadow-lg shadow-indigo-500/20",children:p?e.jsx(Ie,{className:"w-6 h-6"}):e.jsx(Ue,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 tracking-tight",children:p?"Edit Action Item":"New Action Item"}),e.jsx("p",{className:"mt-1 text-sm text-slate-500 font-medium",children:"Define tasks, assign ownership, and track progress."})]})]}),e.jsx("button",{onClick:A,className:"rounded-full p-2 text-slate-400 hover:bg-slate-100 hover:text-slate-600 transition-colors",children:e.jsx(Be,{className:"w-5 h-5"})})]}),e.jsxs("form",{id:"action-form",onSubmit:W,className:"px-6 py-6 space-y-6 bg-white/50",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"absolute -top-2 left-3 bg-white px-1 text-xs font-bold text-indigo-600 uppercase tracking-wider",children:"Task Name"}),e.jsx("input",{type:"text",required:!0,className:"block w-full rounded-xl border-slate-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-lg font-semibold py-3 px-4 bg-slate-50/50 transition-all hover:bg-white focus:bg-white",placeholder:"e.g., Conduct root cause analysis workshop",value:g.name,onChange:i=>C({...g,name:i.target.value}),autoFocus:!0})]}),e.jsx("div",{className:"relative",children:e.jsx("textarea",{rows:3,className:"block w-full rounded-xl border-slate-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm py-3 px-4 bg-slate-50/50 transition-all hover:bg-white focus:bg-white resize-none",placeholder:"Describe the deliverables and acceptance criteria...",value:g.description||"",onChange:i=>C({...g,description:i.target.value})})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 p-4 bg-slate-50/50 rounded-2xl border border-slate-100/80",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-800 font-bold text-sm border-b border-slate-200 pb-2 mb-2",children:[e.jsx(_e,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{children:"Ownership"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Owner"}),e.jsx("input",{type:"text",className:"block w-full rounded-lg border-slate-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2",placeholder:"e.g., John Doe",value:g.owner,onChange:i=>C({...g,owner:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Group / Workstream"}),e.jsx("input",{type:"text",className:"block w-full rounded-lg border-slate-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2",placeholder:"e.g., Engineering",value:g.group||"",onChange:i=>C({...g,group:i.target.value})})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 bg-slate-50/50 rounded-2xl border border-slate-100/80",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-800 font-bold text-sm border-b border-slate-200 pb-2 mb-2",children:[e.jsx(re,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{children:"Timeline"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",required:!0,className:"block w-full rounded-lg border-slate-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2",value:g.startDate,onChange:i=>C({...g,startDate:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"End Date"}),e.jsx("input",{type:"date",required:!0,className:"block w-full rounded-lg border-slate-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2",value:g.endDate,onChange:i=>C({...g,endDate:i.target.value})})]})]})]}),e.jsxs("div",{className:"sm:col-span-2 space-y-4 p-4 bg-gradient-to-r from-slate-50 to-white rounded-2xl border border-slate-100/80",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 pb-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-800 font-bold text-sm",children:[e.jsx(ye,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{children:"Status & Progress"})]}),e.jsxs("div",{className:"text-xs font-bold text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full",children:[g.progress,"% Complete"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-2",children:"Current Status"}),e.jsx("div",{className:"flex gap-2",children:[{value:"Not Started",icon:rt,color:"text-slate-400",bg:"bg-slate-100"},{value:"In Progress",icon:ye,color:"text-amber-500",bg:"bg-amber-50"},{value:"Completed",icon:at,color:"text-emerald-500",bg:"bg-emerald-50"}].map(i=>e.jsxs("button",{type:"button",onClick:()=>C({...g,status:i.value}),className:S("flex-1 flex flex-col items-center justify-center p-2 rounded-xl border transition-all duration-200",g.status===i.value?`border-${i.color.split("-")[1]}-500 ${i.bg} ring-1 ring-${i.color.split("-")[1]}-500`:"border-slate-200 hover:bg-slate-50 hover:border-slate-300"),children:[e.jsx(i.icon,{className:S("w-5 h-5 mb-1",g.status===i.value?i.color:"text-slate-400")}),e.jsx("span",{className:S("text-[10px] font-bold uppercase",g.status===i.value?"text-slate-900":"text-slate-500"),children:i.value})]},i.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-2",children:"Progress Bar"}),e.jsx("div",{className:"relative h-4 bg-slate-100 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:S("absolute top-0 left-0 h-full transition-all duration-500 ease-out rounded-full",g.status==="Completed"?"bg-emerald-500":"bg-indigo-500"),style:{width:`${g.progress}%`}})}),e.jsx("input",{type:"range",min:"0",max:"100",step:"5",className:"w-full mt-3 accent-indigo-600 cursor-pointer",value:g.progress,onChange:i=>C({...g,progress:parseInt(i.target.value)})})]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 px-6 py-4 flex flex-col sm:flex-row-reverse gap-3 border-t border-slate-100",children:[e.jsx("button",{type:"submit",form:"action-form",className:"w-full sm:w-auto inline-flex justify-center items-center rounded-xl border border-transparent shadow-lg shadow-indigo-500/30 px-6 py-2.5 bg-gradient-to-r from-indigo-600 to-violet-600 text-base font-bold text-white hover:from-indigo-700 hover:to-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all transform hover:scale-[1.02]",children:p?"Save Changes":"Create Task"}),e.jsx("button",{type:"button",onClick:A,className:"w-full sm:w-auto inline-flex justify-center items-center rounded-xl border border-slate-200 shadow-sm px-6 py-2.5 bg-white text-base font-bold text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-all",children:"Cancel"}),p&&X&&e.jsx("button",{type:"button",onClick:()=>{confirm("Are you sure you want to delete this task?")&&(X(p.id),A())},className:"w-full sm:w-auto sm:mr-auto inline-flex justify-center items-center rounded-xl border border-transparent px-4 py-2.5 text-base font-bold text-red-600 hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-all",children:"Delete"})]})]})]})]})},ot=40,De=()=>[],ct=()=>{const{id:Y}=Je(),{a3Cases:J,updateA3Case:V,selectedModel:X}=Ve(),p=J.find(a=>a.id===Y),[v,T]=h.useState(De()),[M,g]=h.useState({start:j(new Date),end:j(E(new Date,90))}),[C,A]=h.useState(!1),[W,i]=h.useState(null),[G,K]=h.useState(void 0),[U,Te]=h.useState({}),[B,ne]=h.useState(1),[b,Me]=h.useState("week"),[oe,le]=h.useState(!1),[ie,q]=h.useState(null),[de,Ee]=h.useState(256),[ce,ue]=h.useState(!1),[me,Ae]=h.useState(0),[xe,Pe]=h.useState(256),[z,ge]=h.useState(null),[F,he]=h.useState(null),[pe,Le]=h.useState(0),[L,fe]=h.useState(null);h.useEffect(()=>{p&&(p.actionPlanTasks&&p.actionPlanTasks.length>0?T(p.actionPlanTasks):T(De()))},[p]),h.useEffect(()=>{if(!v.length)return;let a=null,s=null;v.forEach(r=>{const n=new Date(r.startDate),t=new Date(r.endDate);isNaN(n.getTime())||(!a||n<a)&&(a=n),isNaN(t.getTime())||(!s||t>s)&&(s=t)}),!(!a||!s)&&g(r=>{const n=new Date(r.start),t=new Date(r.end);let o=r.start,l=r.end;return(isNaN(n.getTime())||a<n)&&(o=j(a)),(isNaN(t.getTime())||s>t)&&(l=j(s)),o===r.start&&l===r.end?r:{start:o,end:l}})},[v]),h.useEffect(()=>{if(!ce)return;const a=r=>{const n=r.clientX-me;let t=xe+n;t<200&&(t=200),t>480&&(t=480),Ee(t)},s=()=>{ue(!1)};return window.addEventListener("mousemove",a),window.addEventListener("mouseup",s),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",s)}},[ce,me,xe]);const O=a=>{p&&V({...p,actionPlanTasks:a})},$e=h.useMemo(()=>{const a={},s=[];v.forEach(t=>{t.group?(a[t.group]||(a[t.group]=[]),a[t.group].push(t)):s.push(t)});const r=Object.keys(a),n=[];return s.forEach(t=>n.push({type:"task",task:t,id:t.id})),r.forEach(t=>{n.push({type:"group",name:t,id:`group-${t}`}),U[t]!==!1&&a[t].forEach(o=>n.push({type:"task",task:o,id:o.id}))}),n},[v,U]),ze=a=>{Te(s=>({...s,[a]:!s[a]}))},D=(b==="month"?100:b==="week"?60:ot)*B,d=h.useMemo(()=>{const a=new Date(M.start),s=new Date(M.end);if(isNaN(a.getTime())||isNaN(s.getTime())||a>s)return[];const r=[];let n=new Date(a);if(b==="day")for(;n<=s;)qe(n)||r.push({date:new Date(n),label:n.getDate().toString(),fullLabel:j(n),id:j(n)}),n=E(n,1);else if(b==="week"){let t=new Date(n);const o=t.getDay(),l=o===0?6:o-1;for(t.setDate(t.getDate()-l);t<=s;){const c=`${t.toLocaleString("default",{month:"short"})} ${t.getDate()}`;r.push({date:new Date(t),label:c,fullLabel:`Week of ${j(t)}`,id:j(t)}),t=E(t,7)}}else if(b==="month"){let t=new Date(n);for(t.setDate(1);t<=s;)r.push({date:new Date(t),label:t.toLocaleString("default",{month:"short"}),fullLabel:`${t.toLocaleString("default",{month:"long"})} ${t.getFullYear()}`,id:`${t.getFullYear()}-${t.getMonth()}`}),t=new Date(t.getFullYear(),t.getMonth()+1,1)}return r},[M,b]),Ye=a=>{const s=new Date(a.startDate),r=new Date(a.endDate);let n=-1,t=-1;b==="day"?(n=d.findIndex(m=>m.id===a.startDate),t=d.findIndex(m=>m.id===a.endDate)):b==="week"?(n=d.findIndex(m=>{const w=m.date,f=E(w,6);return s>=w&&s<=f}),t=d.findIndex(m=>{const w=m.date,f=E(w,6);return r>=w&&r<=f})):b==="month"&&(n=d.findIndex(m=>m.date.getMonth()===s.getMonth()&&m.date.getFullYear()===s.getFullYear()),t=d.findIndex(m=>m.date.getMonth()===r.getMonth()&&m.date.getFullYear()===r.getFullYear()));const o=d[0],l=d[d.length-1];if(!o||!l)return null;const c=o.date.getTime();let u=l.date.getTime();if(b==="week"&&(u=E(l.date,6).getTime()),b==="month"&&(u=new Date(l.date.getFullYear(),l.date.getMonth()+1,0).getTime()),r.getTime()<c||s.getTime()>u)return null;if(n===-1&&(s.getTime()<c?n=0:(n=d.findIndex(m=>m.date>=s),n===-1&&(n=0))),t===-1){if(r.getTime()>u)t=d.length-1;else for(let m=d.length-1;m>=0;m--)if(d[m].date<=r){t=m;break}}if(n===-1||t===-1||n>t)return null;const N=n*D,k=(t-n+1)*D;return{left:N,width:k}},Fe=()=>{i(null),K(void 0),A(!0)},H=a=>{i(null),K(a),A(!0)},Z=(a,s)=>{a.stopPropagation(),i(s),A(!0)},Oe=a=>{let s;W?s=v.map(r=>r.id===a.id?a:r):s=[...v,a],T(s),O(s)},Re=a=>{const s=v.filter(r=>r.id!==a);T(s),O(s)},be=a=>{Me(a)},Xe=async()=>{var t,o,l;if(!p)return;const a=p.problemStatement||"",s=p.dataAnalysisObservations||"",r=p.rootCause||"",n=p.problemContext||"";if(!a.trim()||!s.trim()||!r.trim()){q("To generate an action plan, fill in Problem Statement, Key Observations from Data, and Identified Root Cause.");return}le(!0),q(null);try{const u=[{role:"system",content:`You are an expert A3 Problem Solving coach.

You will receive:
- A3 Problem Statement
- Key observations from data analysis
- Identified root cause

Your task is to propose a practical, time-phased action plan that addresses the root cause and improves the problem.

Always respond in English, even if the user's inputs are in another language.

Use ${j(new Date)} as today's date when planning the timeline.

Return JSON ONLY with this structure:
{
  "tasks": [
    {
      "name": "short action title",
      "description": "detailed what/how so a team can execute",
      "owner": "role or function (e.g. Production Supervisor)",
      "group": "theme or workstream name",
      "startDate": "YYYY-MM-DD",
      "endDate": "YYYY-MM-DD",
      "status": "Not Started" | "In Progress" | "Completed",
      "progress": number
    }
  ]
}`},{role:"user",content:`Problem Statement:
${a}`+(n?`

Additional Context:
${n}`:"")+`

Key Observations from Data:
${s}

Identified Root Cause:
${r}`}],N=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:X,messages:u,stream:!1})});if(!N.ok)throw new Error("Failed to generate action plan");let m=((l=(o=(t=(await N.json()).choices)==null?void 0:t[0])==null?void 0:o.message)==null?void 0:l.content)||"";m=m.replace(/```json/gi,"").replace(/```/g,"").trim();let w;try{w=JSON.parse(m)}catch{throw new Error("Invalid AI response format")}const f=Array.isArray(w==null?void 0:w.tasks)?w.tasks:Array.isArray(w)?w:[];if(!Array.isArray(f)||f.length===0)throw new Error("AI did not return any tasks");const P=f.map((x,I)=>{const $=typeof x.name=="string"&&x.name.trim()?x.name.trim():`Action ${I+1}`,R=typeof x.description=="string"?x.description.trim():"",Ge=typeof x.owner=="string"?x.owner.trim():p.owner||"",Ke=typeof x.group=="string"&&x.group.trim()?x.group.trim():void 0,we=/^\d{4}-\d{2}-\d{2}$/;let _;if(typeof x.startDate=="string"&&we.test(x.startDate.trim()))_=x.startDate.trim();else{const ae=E(new Date,I*7);_=j(ae)}let ee;if(typeof x.endDate=="string"&&we.test(x.endDate.trim()))ee=x.endDate.trim();else{const ae=E(new Date(_),7);ee=j(ae)}let te="Not Started";(x.status==="In Progress"||x.status==="Completed")&&(te=x.status);let se=0;return typeof x.progress=="number"&&x.progress>=0&&x.progress<=100?se=Math.round(x.progress):te==="Completed"&&(se=100),{id:Ce(),name:$,description:R,owner:Ge,group:Ke,startDate:_,endDate:ee,status:te,progress:se}}),y=[...v,...P];T(y),O(y)}catch(c){q((c==null?void 0:c.message)||"Failed to generate action plan. Please try again.")}finally{le(!1)}},We=a=>{const{source:s,destination:r}=a;if(!r||s.droppableId===r.droppableId&&s.index===r.index)return;const n={ungrouped:[]},t=v.filter(f=>!f.group);n.ungrouped=[...t];const o=v.filter(f=>!!f.group).reduce((f,P)=>{const y=P.group;return f[y]||(f[y]=[]),f[y].push(P),f},{});Object.assign(n,o);const l=s.droppableId==="ungrouped"?"ungrouped":s.droppableId.replace("group-",""),c=r.droppableId==="ungrouped"?"ungrouped":r.droppableId.replace("group-",""),u=n[l],N=n[c];if(!u||!N)return;const[k]=u.splice(s.index,1);l!==c&&(c==="ungrouped"?k.group=void 0:k.group=c),N.splice(r.index,0,k);const m=Object.keys(n).filter(f=>f!=="ungrouped");let w=[...n.ungrouped];m.forEach(f=>{w=[...w,...n[f]]}),T(w),O(w)},Q=(a,s,r)=>{a.stopPropagation(),a.preventDefault(),ge(s.id),he(r),Le(a.clientX),fe({...s})};return h.useEffect(()=>{const a=r=>{if(!z||!F||!L)return;const n=r.clientX-pe,t=Math.round(n/D);if(t===0)return;const o=v.map(l=>{if(l.id!==z)return l;let c=-1,u=-1;if(b==="day")c=d.findIndex(y=>y.id===L.startDate),u=d.findIndex(y=>y.id===L.endDate);else if(b==="week"){const y=new Date(L.startDate),x=new Date(L.endDate);c=d.findIndex(I=>{const $=I.date,R=E($,6);return y>=$&&y<=R}),u=d.findIndex(I=>{const $=I.date,R=E($,6);return x>=$&&x<=R})}else if(b==="month"){const y=new Date(L.startDate),x=new Date(L.endDate);c=d.findIndex(I=>I.date.getMonth()===y.getMonth()&&I.date.getFullYear()===y.getFullYear()),u=d.findIndex(I=>I.date.getMonth()===x.getMonth()&&I.date.getFullYear()===x.getFullYear())}if(c===-1||u===-1)return l;let N=c,k=u;F==="move"?(N=c+t,k=u+t):F==="resize-left"?(N=c+t,N>k&&(N=k)):F==="resize-right"&&(k=u+t,k<N&&(k=N)),N<0&&(N=0),k>=d.length&&(k=d.length-1);let m="",w="";const f=d[N],P=d[k];if(!f||!P)return l;if(b==="day")m=f.id,w=P.id;else if(b==="week")m=j(f.date),w=j(E(P.date,6));else if(b==="month"){m=j(f.date);const y=new Date(P.date.getFullYear(),P.date.getMonth()+1,0);w=j(y)}return{...l,startDate:m,endDate:w}});T(o),O(o)},s=()=>{z&&(ge(null),he(null),fe(null))};return z&&(window.addEventListener("mousemove",a),window.addEventListener("mouseup",s)),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",s)}},[z,F,pe,L,v,d,D,b]),e.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col h-full bg-slate-50 overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-brand-100 bg-white/80 backdrop-blur-md z-20 sticky left-0",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex bg-slate-100 rounded-xl p-1 shadow-inner border border-slate-200",children:[e.jsx("button",{onClick:()=>be("month"),className:S("px-4 py-1.5 text-xs font-bold rounded-lg transition-all duration-200 uppercase tracking-wider",b==="month"?"bg-white text-brand-600 shadow-md ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700 hover:bg-white/50"),children:"Month"}),e.jsx("button",{onClick:()=>be("week"),className:S("px-4 py-1.5 text-xs font-bold rounded-lg transition-all duration-200 uppercase tracking-wider",b==="week"?"bg-white text-brand-600 shadow-md ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700 hover:bg-white/50"),children:"Week"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-100 rounded-xl p-1 shadow-inner border border-slate-200",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-3 px-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase leading-none mb-1",children:"Start"}),e.jsx("input",{type:"date",value:M.start,onChange:a=>g(s=>({...s,start:a.target.value})),className:"text-xs bg-transparent border-none focus:ring-0 p-0 w-24 font-bold text-slate-700 cursor-pointer"})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase leading-none mb-1",children:"End"}),e.jsx("input",{type:"date",value:M.end,onChange:a=>g(s=>({...s,end:a.target.value})),className:"text-xs bg-transparent border-none focus:ring-0 p-0 w-24 font-bold text-slate-700 cursor-pointer"})]})]}),e.jsxs("div",{className:"flex sm:hidden items-center gap-2 px-1",children:[e.jsxs("label",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-9 h-9 rounded-lg bg-white text-slate-700 shadow-sm border border-slate-200 hover:border-brand-300 transition-colors",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:M.start,onChange:a=>g(s=>({...s,start:a.target.value})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsx("span",{className:"text-slate-300",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("label",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-9 h-9 rounded-lg bg-white text-slate-700 shadow-sm border border-slate-200 hover:border-brand-300 transition-colors",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:M.end,onChange:a=>g(s=>({...s,end:a.target.value})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center bg-slate-100 rounded-xl p-1 shadow-inner border border-slate-200",children:[e.jsx("button",{onClick:()=>ne(Math.max(.5,B-.25)),className:"p-1.5 hover:bg-white rounded-lg transition-colors group",children:e.jsx(He,{className:"w-4 h-4 text-slate-500 group-hover:text-brand-600"})}),e.jsxs("span",{className:"text-xs font-bold text-slate-600 w-12 text-center",children:[Math.round(B*100),"%"]}),e.jsx("button",{onClick:()=>ne(Math.min(2,B+.25)),className:"p-1.5 hover:bg-white rounded-lg transition-colors group",children:e.jsx(Ze,{className:"w-4 h-4 text-slate-500 group-hover:text-brand-600"})})]}),e.jsx("button",{type:"button",onClick:Xe,disabled:oe||!p||!p.problemStatement||!p.dataAnalysisObservations||!p.rootCause,className:"inline-flex items-center px-4 py-2 border border-transparent text-xs font-bold uppercase tracking-wider rounded-xl shadow-lg text-white bg-gradient-to-r from-brand-600 to-brand-700 hover:from-brand-700 hover:to-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 active:scale-95",children:oe?e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"animate-spin -ml-0.5 mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"AI planning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"-ml-0.5 mr-0 sm:mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"AI Action Plan"})]})})]})]}),ie&&e.jsxs("div",{className:"px-4 py-2 bg-red-50 border-b border-red-100 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"}),e.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-tight",children:ie})]}),e.jsx("div",{className:"flex-1 relative select-none overflow-hidden",children:e.jsxs("div",{className:"flex min-w-max h-full",children:[e.jsxs("div",{className:"sticky left-0 z-40 bg-white border-r border-slate-200 shadow-xl flex-shrink-0 flex flex-col h-full",style:{width:de},children:[e.jsxs("div",{className:"h-[60px] border-b border-slate-200 bg-slate-50/80 backdrop-blur-sm flex items-center justify-between px-6 font-black text-[10px] text-slate-400 uppercase tracking-[0.2em] sticky top-0 z-30",children:[e.jsx("span",{children:"Task Catalog"}),e.jsx("button",{onClick:Fe,className:"p-2 rounded-xl bg-accent-600 text-white hover:bg-accent-700 shadow-md hover:shadow-accent-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-500 transition-all duration-200 active:scale-90 group",title:"Add Task",children:e.jsx(et,{className:"w-3.5 h-3.5 group-hover:rotate-90 transition-transform duration-300"})})]}),e.jsx("div",{className:"absolute top-0 right-0 h-full w-1 cursor-col-resize bg-transparent hover:bg-brand-400 transition-colors z-50",onMouseDown:a=>{a.preventDefault(),ue(!0),Ae(a.clientX),Pe(de)}}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:[e.jsx(tt,{onDragEnd:We,children:(()=>{const a={ungrouped:[]},s=v.filter(t=>!t.group);a.ungrouped=[...s];const r=v.filter(t=>!!t.group).reduce((t,o)=>{const l=o.group;return t[l]||(t[l]=[]),t[l].push(o),t},{}),n=Object.keys(r);return e.jsxs(e.Fragment,{children:[e.jsx(je,{droppableId:"ungrouped",children:t=>e.jsxs("div",{ref:t.innerRef,...t.droppableProps,children:[a.ungrouped.map((o,l)=>e.jsx(Ne,{draggableId:o.id,index:l,children:c=>e.jsxs("div",{ref:c.innerRef,...c.draggableProps,className:"h-[56px] border-b border-slate-50 flex items-center px-4 hover:bg-brand-50/30 group cursor-pointer bg-white transition-colors",onDoubleClick:u=>Z(u,o),title:o.description,children:[e.jsx("div",{...c.dragHandleProps,className:"mr-3 text-slate-300 cursor-grab active:cursor-grabbing hover:text-brand-400 transition-colors",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700 truncate group-hover:text-brand-700 transition-colors",children:o.name||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("span",{className:"text-[10px] font-black text-slate-400 group-hover:text-brand-500",children:[Math.round(o.progress),"%"]}),e.jsx("div",{className:S("w-2.5 h-2.5 rounded-full flex-shrink-0 ring-2 ring-white shadow-sm",o.status==="Completed"?"bg-accent-500":o.status==="In Progress"?"bg-brand-500 animate-pulse":"bg-slate-300")})]})]}),e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wide truncate mt-0.5",children:o.owner})]})]})},o.id)),t.placeholder]})}),n.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"h-[40px] border-y border-slate-100 flex items-center px-4 bg-slate-50/50 hover:bg-slate-100 cursor-pointer transition-colors",onClick:()=>ze(t),children:[U[t]!==!1?e.jsx(st,{className:"w-3.5 h-3.5 mr-2 text-slate-400"}):e.jsx(ve,{className:"w-3.5 h-3.5 mr-2 text-slate-400"}),e.jsx("span",{className:"text-[10px] font-black text-brand-600 uppercase tracking-widest",children:t})]}),U[t]!==!1&&e.jsx(je,{droppableId:`group-${t}`,children:o=>e.jsxs("div",{ref:o.innerRef,...o.droppableProps,children:[r[t].map((l,c)=>e.jsx(Ne,{draggableId:l.id,index:c,children:u=>e.jsxs("div",{ref:u.innerRef,...u.draggableProps,className:"h-[56px] border-b border-slate-50 flex items-center px-4 hover:bg-brand-50/30 group cursor-pointer bg-white transition-colors",onDoubleClick:N=>Z(N,l),title:l.description,children:[e.jsx("div",{...u.dragHandleProps,className:"mr-3 text-slate-300 cursor-grab active:cursor-grabbing hover:text-brand-400 transition-colors",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700 truncate group-hover:text-brand-700 transition-colors",children:l.name||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("span",{className:"text-[10px] font-black text-slate-400 group-hover:text-brand-500",children:[Math.round(l.progress),"%"]}),e.jsx("div",{className:S("w-2.5 h-2.5 rounded-full flex-shrink-0 ring-2 ring-white shadow-sm",l.status==="Completed"?"bg-accent-500":l.status==="In Progress"?"bg-brand-500 animate-pulse":"bg-slate-300")})]})]}),e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wide truncate mt-0.5",children:l.owner})]})]})},l.id)),o.placeholder]})})]},t))]})})()}),Array.from({length:Math.max(0,10-v.length)}).map((a,s)=>e.jsx("div",{className:"h-[56px] border-b border-slate-50 bg-slate-50/10"},`empty-${s}`))]})]}),e.jsxs("div",{className:"relative flex-1 overflow-auto custom-scrollbar",children:[e.jsx("div",{className:"flex h-[60px] border-b border-slate-200 bg-slate-50/80 backdrop-blur-sm sticky top-0 z-20",children:d.map((a,s)=>{const r=b==="day"?j(a.date)===j(new Date):!1;return e.jsxs("div",{className:S("flex-shrink-0 border-r border-slate-200 flex flex-col items-center justify-center overflow-hidden px-0.5 transition-colors",r?"bg-brand-50/50":""),style:{width:D},title:a.fullLabel,children:[e.jsx("span",{className:S("font-black text-slate-600 uppercase tracking-tighter whitespace-nowrap",D<45?"text-[9px]":"text-[10px]"),children:D<40&&b==="week"?`${a.date.getMonth()+1}/${a.date.getDate()}`:a.label}),b==="day"&&D>=30&&e.jsx("span",{className:"text-slate-400 font-bold text-[8px] uppercase tracking-widest",children:a.date.toLocaleDateString("en-US",{weekday:"narrow"})}),r&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-brand-500"})]},s)})}),e.jsxs("div",{className:"relative",style:{minWidth:d.length*D},children:[e.jsx("div",{className:"absolute inset-0 flex pointer-events-none",children:d.map((a,s)=>e.jsx("div",{className:S("flex-shrink-0 border-r border-slate-100 h-full"),style:{width:D}},s))}),$e.map(a=>{if(a.type==="group")return e.jsx("div",{className:"h-[40px] border-b border-slate-100 bg-slate-50/30"},a.id);const s=a.task,r=Ye(s);if(!r)return e.jsx("div",{className:"h-[56px] border-b border-slate-50 relative group",children:e.jsx("div",{className:"absolute inset-0 z-0 hover:bg-brand-50/10 transition-colors",onClick:o=>{const l=o.currentTarget.getBoundingClientRect(),c=o.clientX-l.left,u=Math.floor(c/D);u>=0&&u<d.length&&H(j(d[u].date))}})},s.id);const{left:n,width:t}=r;return e.jsxs("div",{className:"h-[56px] border-b border-slate-50 relative group",children:[e.jsx("div",{className:"absolute inset-0 z-0 hover:bg-brand-50/10 transition-colors",onClick:o=>{const l=o.currentTarget.getBoundingClientRect(),c=o.clientX-l.left,u=Math.floor(c/D);u>=0&&u<d.length&&H(j(d[u].date))}}),e.jsxs("div",{className:S("absolute top-3 h-8 rounded-lg shadow-lg border-2 flex items-center justify-start px-3 text-[10px] font-bold text-white overflow-hidden cursor-move z-10 transition-all duration-200 group-hover:scale-[1.02] group-hover:z-20",s.status==="Completed"?"bg-accent-500 border-accent-600/20":s.status==="In Progress"?"bg-brand-500 border-brand-600/20":"bg-slate-400 border-slate-500/20",z===s.id?"ring-4 ring-brand-400/30 opacity-90 scale-105 z-30":""),style:{left:Math.max(0,n),width:Math.max(D,t)},onMouseDown:o=>Q(o,s,"move"),onDoubleClick:o=>Z(o,s),children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-2.5 cursor-ew-resize hover:bg-white/20 transition-colors",onMouseDown:o=>Q(o,s,"resize-left")}),e.jsxs("div",{className:"flex flex-col min-w-0 overflow-hidden",children:[e.jsx("span",{className:"truncate drop-shadow-sm uppercase tracking-wider",children:s.name}),t>120&&e.jsx("div",{className:"h-1 bg-white/30 rounded-full mt-0.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-white transition-all duration-500",style:{width:`${s.progress}%`}})})]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2.5 cursor-ew-resize hover:bg-white/20 transition-colors",onMouseDown:o=>Q(o,s,"resize-right")})]})]},s.id)}),Array.from({length:Math.max(0,10-v.length)}).map((a,s)=>e.jsx("div",{className:"h-[56px] border-b border-slate-50 bg-slate-50/10 relative",children:e.jsx("div",{className:"absolute inset-0 z-0 hover:bg-brand-50/5 transition-colors",onClick:r=>{const n=r.currentTarget.getBoundingClientRect(),t=r.clientX-n.left,o=Math.floor(t/D);o>=0&&o<d.length&&H(j(d[o].date))}})},`empty-row-${s}`))]})]})]})}),e.jsx(nt,{isOpen:C,onClose:()=>A(!1),onSave:Oe,onDelete:Re,initialData:W,defaultStartDate:G})]})};export{ct as default};
