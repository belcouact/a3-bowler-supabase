import{c as O,W as I,Z as R,r,O as e,a5 as j,d as W,S as w,X as F,P as M}from"./index-ZgiumcwN.js";import{A as V}from"./alert-circle-C0BsCk87.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=O("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),T=()=>{const{id:N}=I(),{a3Cases:y,updateA3Case:d}=R(),t=y.find(s=>s.id===N),a=r.useRef(null),[h,p]=r.useState(!1),[n,i]=r.useState(null),[b,u]=r.useState(null),[c,k]=r.useState(!1),[S,f]=r.useState("");r.useEffect(()=>{if(t&&a.current){const s=t.problemStatement||"";a.current.value!==s&&(a.current.value=s)}},[t==null?void 0:t.problemStatement]),r.useEffect(()=>{t&&f(t.problemContext||"")},[t==null?void 0:t.problemContext]);const C=async()=>{var s,l,g;if(t!=null&&t.problemStatement){p(!0),u(null),i(null);try{const m=(t.problemContext||"").trim(),E=[{role:"system",content:`You are an expert A3 Problem Solving coach.
          The user will provide a Problem Statement.
          
          Instructions:
          1. Assess if the problem statement is good using the 5W2H criteria (Who, What, Where, When, Which, How Often, How Much Impact).
          2. Provide a critique in English, even if the input is in another language.
          3. Offer an improved, clearer version of the problem statement in English.
          
          Requirements:
          - **Critique**: Be specific about what is missing or vague. Use Markdown.
          - **Improved Version**: Professional, concise, and includes all key aspects. No analysis or extra text, just the statement.
          - **Readability**: Break text into short paragraphs.
          
          RETURN JSON ONLY with keys:
          - "critique": string (markdown supported)
          - "improved_version": string
          `},{role:"user",content:`Problem Statement:
${t.problemStatement}`+(m?`

Additional Context:
${m}`:"")}],v=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"deepseek",messages:E,stream:!1})});if(!v.ok)throw new Error("Failed to fetch assessment");let o=((g=(l=(s=(await v.json()).choices)==null?void 0:s[0])==null?void 0:l.message)==null?void 0:g.content)||"{}";o=o.replace(/^```json\s*|\s*```$/g,"").replace(/^```\s*|\s*```$/g,"");try{const x=JSON.parse(o);i(x)}catch(x){console.error("JSON Parse Error",x),i({critique:o,improved_version:""})}}catch{u("Failed to assess problem statement. Please try again.")}finally{p(!1)}}},A=()=>{if(t&&a.current){const s=a.current.value;s!==t.problemStatement&&d({...t,problemStatement:s})}},P=s=>{if(!t)return;const l=s.target.value;f(l),d({...t,problemContext:l})};return t?e.jsxs("div",{className:"max-w-4xl mx-auto space-y-10",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-brand-50 rounded-lg text-brand-600",children:e.jsx(q,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 font-display",children:"Problem Statement"})]}),e.jsx("p",{className:"text-slate-500 text-lg leading-relaxed max-w-2xl",children:"Clearly define the gap between the current state and the desired state. A well-defined problem is half-solved."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden transition-all duration-300 focus-within:ring-4 focus-within:ring-brand-50 focus-within:border-brand-300",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center",children:[e.jsx("label",{htmlFor:"problem",className:"text-sm font-bold text-slate-700 uppercase tracking-wider",children:"Problem Description"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{type:"button",onClick:()=>k(s=>!s),className:W("px-3 py-1.5 text-xs font-semibold rounded-lg transition-all",c?"bg-slate-200 text-slate-700":"bg-white text-slate-600 border border-slate-200 hover:bg-slate-50"),children:c?"Hide context":"Add context"})})]}),e.jsx("textarea",{ref:a,id:"problem",rows:8,className:"w-full px-6 py-4 text-slate-700 placeholder-slate-400 border-none focus:ring-0 resize-none text-lg leading-relaxed",placeholder:"Describe the problem in detail. Consider: What is happening? Who is affected? When did it start?",defaultValue:t.problemStatement||"",onBlur:A}),c&&e.jsxs("div",{className:"px-6 py-4 border-t border-slate-100 bg-slate-50/30",children:[e.jsx("label",{htmlFor:"problemContext",className:"block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2",children:"Additional Context"}),e.jsx("textarea",{id:"problemContext",rows:3,className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 placeholder-slate-400 focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-sm",placeholder:"Add background, constraints, or any context that helps AI understand the problem.",value:S,onChange:P})]}),e.jsx("div",{className:"px-6 py-4 bg-slate-50/50 border-t border-slate-100 flex justify-end",children:e.jsx("button",{onClick:C,disabled:h||!t.problemStatement,className:"group relative inline-flex items-center gap-2 px-6 py-2.5 bg-brand-600 hover:bg-brand-700 text-white text-sm font-bold rounded-xl transition-all shadow-md hover:shadow-lg hover:-translate-y-0.5 disabled:opacity-50 disabled:translate-y-0 disabled:shadow-none",children:h?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Analyzing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 transition-transform group-hover:rotate-12"}),e.jsx("span",{children:"AI Assessment"})]})})})]}),b&&e.jsx("div",{className:"rounded-2xl bg-red-50 border border-red-100 p-4 animate-in fade-in slide-in-from-top-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-red-500 shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-red-800",children:"Assessment Error"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:b})]})]})}),n&&e.jsxs("div",{className:"bg-white rounded-2xl border-2 border-brand-100 shadow-xl overflow-hidden animate-in fade-in slide-in-from-bottom-6 duration-500",children:[e.jsxs("div",{className:"bg-brand-600 px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx("div",{className:"p-1.5 bg-white/20 rounded-lg",children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider",children:"AI Coach Feedback"})]}),e.jsx("button",{onClick:()=>i(null),className:"text-white/70 hover:text-white transition-colors",children:e.jsx(F,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-brand-500"}),"Deep Analysis"]}),e.jsx("div",{className:"prose prose-slate prose-sm max-w-none text-slate-700 bg-slate-50 p-6 rounded-2xl border border-slate-100 leading-relaxed italic",children:n.critique})]}),n.improved_version&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-accent-500"}),"Recommended Version"]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-brand-500 to-accent-500 rounded-2xl blur opacity-20 group-hover:opacity-30 transition duration-1000"}),e.jsx("div",{className:"relative bg-white border border-accent-100 p-6 rounded-2xl text-slate-900 font-medium leading-relaxed shadow-sm",children:n.improved_version})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>{d({...t,problemStatement:n.improved_version}),a.current&&(a.current.value=n.improved_version)},className:"inline-flex items-center gap-2 px-6 py-2.5 bg-accent-50 text-accent-700 hover:bg-accent-100 text-sm font-bold rounded-xl transition-all border border-accent-200",children:[e.jsx(M,{className:"w-4 h-4"}),"Apply Improved Statement"]})})]})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center py-24",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(j,{className:"w-10 h-10 animate-spin text-brand-600"}),e.jsx("p",{className:"mt-4 text-slate-500 font-medium animate-pulse",children:"Loading workspace data..."})]})})};export{T as default};
