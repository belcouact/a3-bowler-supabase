import{c as Ge,r as g,ad as De,O as e,a3 as be,X as Ke,W as Ue,Z as Be,ac as j,ae as C,an as _e,d as E,a2 as we,ao as ve,ap as qe,aq as Ve,a5 as Ze,S as He,ar as Je,as as Qe,at as je,au as ye,av as et}from"./index-ZgiumcwN.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=Ge("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),tt=({isOpen:z,onClose:A,onSave:B,onDelete:W,initialData:p,defaultStartDate:v})=>{const[c,N]=g.useState({id:"",name:"",description:"",owner:"",group:"",startDate:"",endDate:"",status:"Not Started",progress:0});if(g.useEffect(()=>{if(z)if(p)N(p);else{const f=new Date().toISOString().split("T")[0],$=v||f,F=new Date(new Date($).getTime()+7*24*60*60*1e3).toISOString().split("T")[0];N({id:De(),name:"",description:"",owner:"",group:"",startDate:$,endDate:F,status:"Not Started",progress:0})}},[z,p,v]),!z)return null;const P=c.status==="Completed"?"bg-emerald-50 text-emerald-700 border-emerald-200":c.status==="In Progress"?"bg-amber-50 text-amber-700 border-amber-200":"bg-gray-100 text-gray-700 border-gray-200",_=f=>{f.preventDefault(),B(c),A()};return e.jsx("div",{className:"fixed inset-0 z-[70] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:A,children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-1 flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-indigo-500 to-blue-500 text-white shadow-md",children:e.jsx(be,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg leading-6 font-semibold text-gray-900",id:"modal-title",children:p?"Edit Action Item":"New Action Item"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Define clear, owned actions that support your A3 plan."})]})]}),e.jsx("button",{onClick:A,className:"ml-4 rounded-full p-1.5 text-gray-400 hover:bg-gray-100 hover:text-gray-600 transition",children:e.jsx(Ke,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mb-4 flex items-start gap-2 rounded-md border border-indigo-50 bg-indigo-50/80 px-3 py-2 text-xs text-indigo-800",children:[e.jsx(be,{className:"mt-0.5 h-4 w-4 flex-shrink-0 text-indigo-500"}),e.jsx("p",{children:"Use this card to break the A3 into specific tasks with owners, timing, and progress."})]}),e.jsxs("form",{id:"action-form",onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-gray-50/60 p-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Task overview"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Name the action item and describe what needs to be done."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mt-2 block text-sm font-medium text-gray-700",children:"Task Name"}),e.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.name,onChange:f=>N({...c,name:f.target.value}),autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.description||"",onChange:f=>N({...c,description:f.target.value})})]})]}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Ownership & grouping"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Assign who is responsible and how this task is grouped."})]}),c.group&&e.jsx("span",{className:"hidden sm:inline-flex items-center rounded-full bg-gray-100 px-2 py-0.5 text-[11px] font-medium text-gray-600",children:c.group})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Owner"}),e.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.owner,onChange:f=>N({...c,owner:f.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Group"}),e.jsx("input",{type:"text",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.group||"",onChange:f=>N({...c,group:f.target.value})})]})]})]}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Status & progress"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Track how far this action has moved and what state it is in."})]}),e.jsx("span",{className:`inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-medium ${P}`,children:c.status})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.status,onChange:f=>N({...c,status:f.target.value}),children:[e.jsx("option",{children:"Not Started"}),e.jsx("option",{children:"In Progress"}),e.jsx("option",{children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Progress: ",c.progress,"%"]}),e.jsx("input",{type:"range",min:"0",max:"100",step:"10",className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",value:c.progress,onChange:f=>N({...c,progress:parseInt(f.target.value)})})]})]})]}),e.jsxs("div",{className:"space-y-3 rounded-lg border border-gray-100 bg-white p-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold tracking-wide text-gray-500 uppercase",children:"Timeline"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Set start and end dates so the team can follow up on time."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{type:"date",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.startDate,onChange:f=>N({...c,startDate:f.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{type:"date",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:c.endDate,onChange:f=>N({...c,endDate:f.target.value})})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 flex flex-col sm:flex-row-reverse justify-between items-center gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row-reverse w-full sm:w-auto",children:[e.jsx("button",{type:"submit",form:"action-form",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Save"}),e.jsx("button",{type:"button",onClick:A,className:"mt-3 sm:mt-0 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]}),p&&W&&e.jsx("button",{type:"button",onClick:()=>{confirm("Are you sure you want to delete this task?")&&(W(p.id),A())},className:"mt-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-100 text-base font-medium text-red-700 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Delete"})]})]})]})})},st=40,ke=()=>[],at=()=>{const{id:z}=Ue(),{a3Cases:A,updateA3Case:B,selectedModel:W}=Be(),p=A.find(r=>r.id===z),[v,c]=g.useState(ke()),[N,P]=g.useState({start:j(new Date),end:j(C(new Date,90))}),[_,f]=g.useState(!1),[$,F]=g.useState(null),[Se,se]=g.useState(void 0),[G,Ie]=g.useState({}),[K,re]=g.useState(1),[b,Ce]=g.useState("week"),[ae,ne]=g.useState(!1),[oe,q]=g.useState(null),[le,Te]=g.useState(256),[ie,de]=g.useState(!1),[ce,Me]=g.useState(0),[ue,Ee]=g.useState(256),[Y,me]=g.useState(null),[O,xe]=g.useState(null),[ge,Ae]=g.useState(0),[M,he]=g.useState(null);g.useEffect(()=>{p&&(p.actionPlanTasks&&p.actionPlanTasks.length>0?c(p.actionPlanTasks):c(ke()))},[p]),g.useEffect(()=>{if(!v.length)return;let r=null,s=null;v.forEach(a=>{const n=new Date(a.startDate),t=new Date(a.endDate);isNaN(n.getTime())||(!r||n<r)&&(r=n),isNaN(t.getTime())||(!s||t>s)&&(s=t)}),!(!r||!s)&&P(a=>{const n=new Date(a.start),t=new Date(a.end);let o=a.start,l=a.end;return(isNaN(n.getTime())||r<n)&&(o=j(r)),(isNaN(t.getTime())||s>t)&&(l=j(s)),o===a.start&&l===a.end?a:{start:o,end:l}})},[v]),g.useEffect(()=>{if(!ie)return;const r=a=>{const n=a.clientX-ce;let t=ue+n;t<200&&(t=200),t>480&&(t=480),Te(t)},s=()=>{de(!1)};return window.addEventListener("mousemove",r),window.addEventListener("mouseup",s),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)}},[ie,ce,ue]);const R=r=>{p&&B({...p,actionPlanTasks:r})},Pe=g.useMemo(()=>{const r={},s=[];v.forEach(t=>{t.group?(r[t.group]||(r[t.group]=[]),r[t.group].push(t)):s.push(t)});const a=Object.keys(r),n=[];return s.forEach(t=>n.push({type:"task",task:t,id:t.id})),a.forEach(t=>{n.push({type:"group",name:t,id:`group-${t}`}),G[t]!==!1&&r[t].forEach(o=>n.push({type:"task",task:o,id:o.id}))}),n},[v,G]),Le=r=>{Ie(s=>({...s,[r]:!s[r]}))},S=(b==="month"?100:b==="week"?60:st)*K,i=g.useMemo(()=>{const r=new Date(N.start),s=new Date(N.end);if(isNaN(r.getTime())||isNaN(s.getTime())||r>s)return[];const a=[];let n=new Date(r);if(b==="day")for(;n<=s;)_e(n)||a.push({date:new Date(n),label:n.getDate().toString(),fullLabel:j(n),id:j(n)}),n=C(n,1);else if(b==="week"){let t=new Date(n);const o=t.getDay(),l=o===0?6:o-1;for(t.setDate(t.getDate()-l);t<=s;){const d=`${t.toLocaleString("default",{month:"short"})} ${t.getDate()}`;a.push({date:new Date(t),label:d,fullLabel:`Week of ${j(t)}`,id:j(t)}),t=C(t,7)}}else if(b==="month"){let t=new Date(n);for(t.setDate(1);t<=s;)a.push({date:new Date(t),label:t.toLocaleString("default",{month:"short"}),fullLabel:`${t.toLocaleString("default",{month:"long"})} ${t.getFullYear()}`,id:`${t.getFullYear()}-${t.getMonth()}`}),t=new Date(t.getFullYear(),t.getMonth()+1,1)}return a},[N,b]),Ye=r=>{const s=new Date(r.startDate),a=new Date(r.endDate);let n=-1,t=-1;b==="day"?(n=i.findIndex(m=>m.id===r.startDate),t=i.findIndex(m=>m.id===r.endDate)):b==="week"?(n=i.findIndex(m=>{const w=m.date,h=C(w,6);return s>=w&&s<=h}),t=i.findIndex(m=>{const w=m.date,h=C(w,6);return a>=w&&a<=h})):b==="month"&&(n=i.findIndex(m=>m.date.getMonth()===s.getMonth()&&m.date.getFullYear()===s.getFullYear()),t=i.findIndex(m=>m.date.getMonth()===a.getMonth()&&m.date.getFullYear()===a.getFullYear()));const o=i[0],l=i[i.length-1];if(!o||!l)return null;const d=o.date.getTime();let u=l.date.getTime();if(b==="week"&&(u=C(l.date,6).getTime()),b==="month"&&(u=new Date(l.date.getFullYear(),l.date.getMonth()+1,0).getTime()),a.getTime()<d||s.getTime()>u)return null;if(n===-1&&(s.getTime()<d?n=0:(n=i.findIndex(m=>m.date>=s),n===-1&&(n=0))),t===-1){if(a.getTime()>u)t=i.length-1;else for(let m=i.length-1;m>=0;m--)if(i[m].date<=a){t=m;break}}if(n===-1||t===-1||n>t)return null;const y=n*S,D=(t-n+1)*S;return{left:y,width:D}},ze=()=>{F(null),se(void 0),f(!0)},V=r=>{F(null),se(r),f(!0)},Z=(r,s)=>{r.stopPropagation(),F(s),f(!0)},$e=r=>{let s;$?s=v.map(a=>a.id===r.id?r:a):s=[...v,r],c(s),R(s)},Fe=r=>{const s=v.filter(a=>a.id!==r);c(s),R(s)},pe=r=>{Ce(r)},Oe=async()=>{var t,o,l;if(!p)return;const r=p.problemStatement||"",s=p.dataAnalysisObservations||"",a=p.rootCause||"",n=p.problemContext||"";if(!r.trim()||!s.trim()||!a.trim()){q("To generate an action plan, fill in Problem Statement, Key Observations from Data, and Identified Root Cause.");return}ne(!0),q(null);try{const u=[{role:"system",content:`You are an expert A3 Problem Solving coach.

You will receive:
- A3 Problem Statement
- Key observations from data analysis
- Identified root cause

Your task is to propose a practical, time-phased action plan that addresses the root cause and improves the problem.

Always respond in English, even if the user's inputs are in another language.

Use ${j(new Date)} as today's date when planning the timeline.

Return JSON ONLY with this structure:
{
  "tasks": [
    {
      "name": "short action title",
      "description": "detailed what/how so a team can execute",
      "owner": "role or function (e.g. Production Supervisor)",
      "group": "theme or workstream name",
      "startDate": "YYYY-MM-DD",
      "endDate": "YYYY-MM-DD",
      "status": "Not Started" | "In Progress" | "Completed",
      "progress": number
    }
  ]
}`},{role:"user",content:`Problem Statement:
${r}`+(n?`

Additional Context:
${n}`:"")+`

Key Observations from Data:
${s}

Identified Root Cause:
${a}`}],y=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:W,messages:u,stream:!1})});if(!y.ok)throw new Error("Failed to generate action plan");let m=((l=(o=(t=(await y.json()).choices)==null?void 0:t[0])==null?void 0:o.message)==null?void 0:l.content)||"";m=m.replace(/```json/gi,"").replace(/```/g,"").trim();let w;try{w=JSON.parse(m)}catch{throw new Error("Invalid AI response format")}const h=Array.isArray(w==null?void 0:w.tasks)?w.tasks:Array.isArray(w)?w:[];if(!Array.isArray(h)||h.length===0)throw new Error("AI did not return any tasks");const T=h.map((x,I)=>{const L=typeof x.name=="string"&&x.name.trim()?x.name.trim():`Action ${I+1}`,X=typeof x.description=="string"?x.description.trim():"",Xe=typeof x.owner=="string"?x.owner.trim():p.owner||"",We=typeof x.group=="string"&&x.group.trim()?x.group.trim():void 0,fe=/^\d{4}-\d{2}-\d{2}$/;let U;if(typeof x.startDate=="string"&&fe.test(x.startDate.trim()))U=x.startDate.trim();else{const te=C(new Date,I*7);U=j(te)}let J;if(typeof x.endDate=="string"&&fe.test(x.endDate.trim()))J=x.endDate.trim();else{const te=C(new Date(U),7);J=j(te)}let Q="Not Started";(x.status==="In Progress"||x.status==="Completed")&&(Q=x.status);let ee=0;return typeof x.progress=="number"&&x.progress>=0&&x.progress<=100?ee=Math.round(x.progress):Q==="Completed"&&(ee=100),{id:De(),name:L,description:X,owner:Xe,group:We,startDate:U,endDate:J,status:Q,progress:ee}}),k=[...v,...T];c(k),R(k)}catch(d){q((d==null?void 0:d.message)||"Failed to generate action plan. Please try again.")}finally{ne(!1)}},Re=r=>{const{source:s,destination:a}=r;if(!a||s.droppableId===a.droppableId&&s.index===a.index)return;const n={ungrouped:[]},t=v.filter(h=>!h.group);n.ungrouped=[...t];const o=v.filter(h=>!!h.group).reduce((h,T)=>{const k=T.group;return h[k]||(h[k]=[]),h[k].push(T),h},{});Object.assign(n,o);const l=s.droppableId==="ungrouped"?"ungrouped":s.droppableId.replace("group-",""),d=a.droppableId==="ungrouped"?"ungrouped":a.droppableId.replace("group-",""),u=n[l],y=n[d];if(!u||!y)return;const[D]=u.splice(s.index,1);l!==d&&(d==="ungrouped"?D.group=void 0:D.group=d),y.splice(a.index,0,D);const m=Object.keys(n).filter(h=>h!=="ungrouped");let w=[...n.ungrouped];m.forEach(h=>{w=[...w,...n[h]]}),c(w),R(w)},H=(r,s,a)=>{r.stopPropagation(),r.preventDefault(),me(s.id),xe(a),Ae(r.clientX),he({...s})};return g.useEffect(()=>{const r=a=>{if(!Y||!O||!M)return;const n=a.clientX-ge,t=Math.round(n/S);if(t===0)return;const o=v.map(l=>{if(l.id!==Y)return l;let d=-1,u=-1;if(b==="day")d=i.findIndex(k=>k.id===M.startDate),u=i.findIndex(k=>k.id===M.endDate);else if(b==="week"){const k=new Date(M.startDate),x=new Date(M.endDate);d=i.findIndex(I=>{const L=I.date,X=C(L,6);return k>=L&&k<=X}),u=i.findIndex(I=>{const L=I.date,X=C(L,6);return x>=L&&x<=X})}else if(b==="month"){const k=new Date(M.startDate),x=new Date(M.endDate);d=i.findIndex(I=>I.date.getMonth()===k.getMonth()&&I.date.getFullYear()===k.getFullYear()),u=i.findIndex(I=>I.date.getMonth()===x.getMonth()&&I.date.getFullYear()===x.getFullYear())}if(d===-1||u===-1)return l;let y=d,D=u;O==="move"?(y=d+t,D=u+t):O==="resize-left"?(y=d+t,y>D&&(y=D)):O==="resize-right"&&(D=u+t,D<y&&(D=y)),y<0&&(y=0),D>=i.length&&(D=i.length-1);let m="",w="";const h=i[y],T=i[D];if(!h||!T)return l;if(b==="day")m=h.id,w=T.id;else if(b==="week")m=j(h.date),w=j(C(T.date,6));else if(b==="month"){m=j(h.date);const k=new Date(T.date.getFullYear(),T.date.getMonth()+1,0);w=j(k)}return{...l,startDate:m,endDate:w}});c(o),R(o)},s=()=>{Y&&(me(null),xe(null),he(null))};return Y&&(window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)),()=>{window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)}},[Y,O,ge,M,v,i,S,b]),e.jsxs("div",{className:"flex flex-col h-full bg-slate-50 overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-brand-100 bg-white/80 backdrop-blur-md z-20 sticky left-0",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex bg-slate-100 rounded-xl p-1 shadow-inner border border-slate-200",children:[e.jsx("button",{onClick:()=>pe("month"),className:E("px-4 py-1.5 text-xs font-bold rounded-lg transition-all duration-200 uppercase tracking-wider",b==="month"?"bg-white text-brand-600 shadow-md ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700 hover:bg-white/50"),children:"Month"}),e.jsx("button",{onClick:()=>pe("week"),className:E("px-4 py-1.5 text-xs font-bold rounded-lg transition-all duration-200 uppercase tracking-wider",b==="week"?"bg-white text-brand-600 shadow-md ring-1 ring-slate-200":"text-slate-500 hover:text-slate-700 hover:bg-white/50"),children:"Week"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-slate-100 rounded-xl p-1 shadow-inner border border-slate-200",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-3 px-3",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase leading-none mb-1",children:"Start"}),e.jsx("input",{type:"date",value:N.start,onChange:r=>P(s=>({...s,start:r.target.value})),className:"text-xs bg-transparent border-none focus:ring-0 p-0 w-24 font-bold text-slate-700 cursor-pointer"})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase leading-none mb-1",children:"End"}),e.jsx("input",{type:"date",value:N.end,onChange:r=>P(s=>({...s,end:r.target.value})),className:"text-xs bg-transparent border-none focus:ring-0 p-0 w-24 font-bold text-slate-700 cursor-pointer"})]})]}),e.jsxs("div",{className:"flex sm:hidden items-center gap-2 px-1",children:[e.jsxs("label",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-9 h-9 rounded-lg bg-white text-slate-700 shadow-sm border border-slate-200 hover:border-brand-300 transition-colors",children:e.jsx(we,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:N.start,onChange:r=>P(s=>({...s,start:r.target.value})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsx("span",{className:"text-slate-300",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("label",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-9 h-9 rounded-lg bg-white text-slate-700 shadow-sm border border-slate-200 hover:border-brand-300 transition-colors",children:e.jsx(we,{className:"w-4 h-4"})}),e.jsx("input",{type:"date",value:N.end,onChange:r=>P(s=>({...s,end:r.target.value})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center bg-slate-100 rounded-xl p-1 shadow-inner border border-slate-200",children:[e.jsx("button",{onClick:()=>re(Math.max(.5,K-.25)),className:"p-1.5 hover:bg-white rounded-lg transition-colors group",children:e.jsx(qe,{className:"w-4 h-4 text-slate-500 group-hover:text-brand-600"})}),e.jsxs("span",{className:"text-xs font-bold text-slate-600 w-12 text-center",children:[Math.round(K*100),"%"]}),e.jsx("button",{onClick:()=>re(Math.min(2,K+.25)),className:"p-1.5 hover:bg-white rounded-lg transition-colors group",children:e.jsx(Ve,{className:"w-4 h-4 text-slate-500 group-hover:text-brand-600"})})]}),e.jsx("button",{type:"button",onClick:Oe,disabled:ae||!p||!p.problemStatement||!p.dataAnalysisObservations||!p.rootCause,className:"inline-flex items-center px-4 py-2 border border-transparent text-xs font-bold uppercase tracking-wider rounded-xl shadow-lg text-white bg-gradient-to-r from-brand-600 to-brand-700 hover:from-brand-700 hover:to-brand-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 active:scale-95",children:ae?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"animate-spin -ml-0.5 mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"AI planning..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"-ml-0.5 mr-0 sm:mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"AI Action Plan"})]})})]})]}),oe&&e.jsxs("div",{className:"px-4 py-2 bg-red-50 border-b border-red-100 flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"}),e.jsx("span",{className:"text-xs font-bold text-red-600 uppercase tracking-tight",children:oe})]}),e.jsx("div",{className:"flex-1 relative select-none overflow-hidden",children:e.jsxs("div",{className:"flex min-w-max h-full",children:[e.jsxs("div",{className:"sticky left-0 z-40 bg-white border-r border-slate-200 shadow-xl flex-shrink-0 flex flex-col h-full",style:{width:le},children:[e.jsxs("div",{className:"h-[60px] border-b border-slate-200 bg-slate-50/80 backdrop-blur-sm flex items-center justify-between px-6 font-black text-[10px] text-slate-400 uppercase tracking-[0.2em] sticky top-0 z-30",children:[e.jsx("span",{children:"Task Catalog"}),e.jsx("button",{onClick:ze,className:"p-2 rounded-xl bg-accent-600 text-white hover:bg-accent-700 shadow-md hover:shadow-accent-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent-500 transition-all duration-200 active:scale-90 group",title:"Add Task",children:e.jsx(Je,{className:"w-3.5 h-3.5 group-hover:rotate-90 transition-transform duration-300"})})]}),e.jsx("div",{className:"absolute top-0 right-0 h-full w-1 cursor-col-resize bg-transparent hover:bg-brand-400 transition-colors z-50",onMouseDown:r=>{r.preventDefault(),de(!0),Me(r.clientX),Ee(le)}}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:[e.jsx(Qe,{onDragEnd:Re,children:(()=>{const r={ungrouped:[]},s=v.filter(t=>!t.group);r.ungrouped=[...s];const a=v.filter(t=>!!t.group).reduce((t,o)=>{const l=o.group;return t[l]||(t[l]=[]),t[l].push(o),t},{}),n=Object.keys(a);return e.jsxs(e.Fragment,{children:[e.jsx(je,{droppableId:"ungrouped",children:t=>e.jsxs("div",{ref:t.innerRef,...t.droppableProps,children:[r.ungrouped.map((o,l)=>e.jsx(ye,{draggableId:o.id,index:l,children:d=>e.jsxs("div",{ref:d.innerRef,...d.draggableProps,className:"h-[56px] border-b border-slate-50 flex items-center px-4 hover:bg-brand-50/30 group cursor-pointer bg-white transition-colors",onDoubleClick:u=>Z(u,o),title:o.description,children:[e.jsx("div",{...d.dragHandleProps,className:"mr-3 text-slate-300 cursor-grab active:cursor-grabbing hover:text-brand-400 transition-colors",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700 truncate group-hover:text-brand-700 transition-colors",children:o.name||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("span",{className:"text-[10px] font-black text-slate-400 group-hover:text-brand-500",children:[Math.round(o.progress),"%"]}),e.jsx("div",{className:E("w-2.5 h-2.5 rounded-full flex-shrink-0 ring-2 ring-white shadow-sm",o.status==="Completed"?"bg-accent-500":o.status==="In Progress"?"bg-brand-500 animate-pulse":"bg-slate-300")})]})]}),e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wide truncate mt-0.5",children:o.owner})]})]})},o.id)),t.placeholder]})}),n.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"h-[40px] border-y border-slate-100 flex items-center px-4 bg-slate-50/50 hover:bg-slate-100 cursor-pointer transition-colors",onClick:()=>Le(t),children:[G[t]!==!1?e.jsx(et,{className:"w-3.5 h-3.5 mr-2 text-slate-400"}):e.jsx(ve,{className:"w-3.5 h-3.5 mr-2 text-slate-400"}),e.jsx("span",{className:"text-[10px] font-black text-brand-600 uppercase tracking-widest",children:t})]}),G[t]!==!1&&e.jsx(je,{droppableId:`group-${t}`,children:o=>e.jsxs("div",{ref:o.innerRef,...o.droppableProps,children:[a[t].map((l,d)=>e.jsx(ye,{draggableId:l.id,index:d,children:u=>e.jsxs("div",{ref:u.innerRef,...u.draggableProps,className:"h-[56px] border-b border-slate-50 flex items-center px-4 hover:bg-brand-50/30 group cursor-pointer bg-white transition-colors",onDoubleClick:y=>Z(y,l),title:l.description,children:[e.jsx("div",{...u.dragHandleProps,className:"mr-3 text-slate-300 cursor-grab active:cursor-grabbing hover:text-brand-400 transition-colors",children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700 truncate group-hover:text-brand-700 transition-colors",children:l.name||"Untitled Task"}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("span",{className:"text-[10px] font-black text-slate-400 group-hover:text-brand-500",children:[Math.round(l.progress),"%"]}),e.jsx("div",{className:E("w-2.5 h-2.5 rounded-full flex-shrink-0 ring-2 ring-white shadow-sm",l.status==="Completed"?"bg-accent-500":l.status==="In Progress"?"bg-brand-500 animate-pulse":"bg-slate-300")})]})]}),e.jsx("div",{className:"text-[10px] font-medium text-slate-400 uppercase tracking-wide truncate mt-0.5",children:l.owner})]})]})},l.id)),o.placeholder]})})]},t))]})})()}),Array.from({length:Math.max(0,10-v.length)}).map((r,s)=>e.jsx("div",{className:"h-[56px] border-b border-slate-50 bg-slate-50/10"},`empty-${s}`))]})]}),e.jsxs("div",{className:"relative flex-1 overflow-auto custom-scrollbar",children:[e.jsx("div",{className:"flex h-[60px] border-b border-slate-200 bg-slate-50/80 backdrop-blur-sm sticky top-0 z-20",children:i.map((r,s)=>{const a=b==="day"?j(r.date)===j(new Date):!1;return e.jsxs("div",{className:E("flex-shrink-0 border-r border-slate-200 flex flex-col items-center justify-center overflow-hidden px-0.5 transition-colors",a?"bg-brand-50/50":""),style:{width:S},title:r.fullLabel,children:[e.jsx("span",{className:E("font-black text-slate-600 uppercase tracking-tighter whitespace-nowrap",S<45?"text-[9px]":"text-[10px]"),children:S<40&&b==="week"?`${r.date.getMonth()+1}/${r.date.getDate()}`:r.label}),b==="day"&&S>=30&&e.jsx("span",{className:"text-slate-400 font-bold text-[8px] uppercase tracking-widest",children:r.date.toLocaleDateString("en-US",{weekday:"narrow"})}),a&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-brand-500"})]},s)})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex pointer-events-none",children:i.map((r,s)=>e.jsx("div",{className:E("flex-shrink-0 border-r border-slate-100 h-full"),style:{width:S}},s))}),Pe.map(r=>{if(r.type==="group")return e.jsx("div",{className:"h-[40px] border-b border-slate-100 bg-slate-50/30"},r.id);const s=r.task,a=Ye(s);if(!a)return e.jsx("div",{className:"h-[56px] border-b border-slate-50 relative group",children:e.jsx("div",{className:"absolute inset-0 z-0 hover:bg-brand-50/10 transition-colors",onClick:o=>{const l=o.currentTarget.getBoundingClientRect(),d=o.clientX-l.left,u=Math.floor(d/S);u>=0&&u<i.length&&V(j(i[u].date))}})},s.id);const{left:n,width:t}=a;return e.jsxs("div",{className:"h-[56px] border-b border-slate-50 relative group",children:[e.jsx("div",{className:"absolute inset-0 z-0 hover:bg-brand-50/10 transition-colors",onClick:o=>{const l=o.currentTarget.getBoundingClientRect(),d=o.clientX-l.left,u=Math.floor(d/S);u>=0&&u<i.length&&V(j(i[u].date))}}),e.jsxs("div",{className:E("absolute top-3 h-8 rounded-lg shadow-lg border-2 flex items-center justify-start px-3 text-[10px] font-bold text-white overflow-hidden cursor-move z-10 transition-all duration-200 group-hover:scale-[1.02] group-hover:z-20",s.status==="Completed"?"bg-accent-500 border-accent-600/20":s.status==="In Progress"?"bg-brand-500 border-brand-600/20":"bg-slate-400 border-slate-500/20",Y===s.id?"ring-4 ring-brand-400/30 opacity-90 scale-105 z-30":""),style:{left:Math.max(0,n),width:Math.max(S,t)},onMouseDown:o=>H(o,s,"move"),onDoubleClick:o=>Z(o,s),children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-2.5 cursor-ew-resize hover:bg-white/20 transition-colors",onMouseDown:o=>H(o,s,"resize-left")}),e.jsxs("div",{className:"flex flex-col min-w-0 overflow-hidden",children:[e.jsx("span",{className:"truncate drop-shadow-sm uppercase tracking-wider",children:s.name}),t>120&&e.jsx("div",{className:"h-1 bg-white/30 rounded-full mt-0.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-white transition-all duration-500",style:{width:`${s.progress}%`}})})]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-2.5 cursor-ew-resize hover:bg-white/20 transition-colors",onMouseDown:o=>H(o,s,"resize-right")})]})]},s.id)}),Array.from({length:Math.max(0,10-v.length)}).map((r,s)=>e.jsx("div",{className:"h-[56px] border-b border-slate-50 bg-slate-50/10 relative",children:e.jsx("div",{className:"absolute inset-0 z-0 hover:bg-brand-50/5 transition-colors",onClick:a=>{const n=a.currentTarget.getBoundingClientRect(),t=a.clientX-n.left,o=Math.floor(t/S);o>=0&&o<i.length&&V(j(i[o].date))}})},`empty-row-${s}`))]})]})]})}),e.jsx(tt,{isOpen:_,onClose:()=>f(!1),onSave:$e,onDelete:Fe,initialData:$,defaultStartDate:Se})]})};export{at as default};
