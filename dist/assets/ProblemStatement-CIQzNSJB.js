import{c as E,V as q,W as M,r as n,O as e,a1 as p,S,X as P,P as W}from"./index-D2Dup-6N.js";import{A}from"./alert-circle-Ch8Pzr8T.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=E("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=E("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),G=()=>{const{id:C}=q(),{a3Cases:R,updateA3Case:u}=M(),s=R.find(t=>t.id===C),r=n.useRef(null),[g,b]=n.useState(!1),[i,m]=n.useState(null),[f,j]=n.useState(null),[y,v]=n.useState(!1),[N,h]=n.useState(null),[w,k]=n.useState(null);n.useEffect(()=>{if(s&&r.current){const t=s.problemStatement||"";r.current.value!==t&&(r.current.value=t)}},[s==null?void 0:s.problemStatement]);const I=async()=>{var t,l,o;if(s!=null&&s.problemStatement){b(!0),j(null),m(null);try{const d=[{role:"system",content:`You are an expert A3 Problem Solving coach.
          The user will provide a Problem Statement.
          
          Instructions:
          1. Assess if the problem statement is good using the 5W2H criteria (Who, What, Where, When, Which, How Often, How Much Impact).
          2. Provide a critique in English, even if the input is in another language.
          3. Offer an improved, clearer version of the problem statement in English.
          
          Requirements:
          - **Critique**: Be specific about what is missing or vague. Use Markdown.
          - **Improved Version**: Professional, concise, and includes all key aspects. No analysis or extra text, just the statement.
          - **Readability**: Break text into short paragraphs.
          
          RETURN JSON ONLY with keys:
          - "critique": string (markdown supported)
          - "improved_version": string
          `},{role:"user",content:`Problem Statement: "${s.problemStatement}"`}],c=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"deepseek",messages:d,stream:!1})});if(!c.ok)throw new Error("Failed to fetch assessment");let a=((o=(l=(t=(await c.json()).choices)==null?void 0:t[0])==null?void 0:l.message)==null?void 0:o.content)||"{}";a=a.replace(/^```json\s*|\s*```$/g,"").replace(/^```\s*|\s*```$/g,"");try{const x=JSON.parse(a);m(x)}catch(x){console.error("JSON Parse Error",x),m({critique:a,improved_version:""})}}catch{j("Failed to assess problem statement. Please try again.")}finally{b(!1)}}},O=async()=>{var t,l,o;if(s!=null&&s.problemStatement){v(!0),k(null),h(null);try{const d=[{role:"system",content:`You are an expert troubleshooting coach, skilled in many areas.
          
          The user will provide a single Problem Statement.

          Your task:
          - Generate a practical troubleshooting plan to address this problem.
          - Respond in English by default, even if the input is in another language.
          
          Structure the response as clear sections with markdown headings:
          1. Immediate Checks
          2. Data Collection
          3. Hypotheses to Test

          For each bullet, be specific and actionable, but concise.`},{role:"user",content:`Problem Statement: "${s.problemStatement}"`}],c=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"deepseek",messages:d,stream:!1})});if(!c.ok)throw new Error("Failed to generate troubleshooting plan");let a=((o=(l=(t=(await c.json()).choices)==null?void 0:t[0])==null?void 0:l.message)==null?void 0:o.content)||"";a=a.replace(/^```[\s\S]*?```/g,"").trim(),h(a)}catch{k("Failed to generate troubleshooting plan. Please try again.")}finally{v(!1)}}},T=()=>{if(s&&r.current){const t=r.current.value;t!==s.problemStatement&&u({...s,problemStatement:t})}};return s?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Problem Statement"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Clearly define the gap between the current state and the desired state."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("label",{htmlFor:"problem",className:"block text-sm font-medium text-gray-700",children:"What is the problem?"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:I,disabled:g||!s.problemStatement,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:g?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"animate-spin -ml-0.5 mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Assessing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"-ml-0.5 mr-0 sm:mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"AI Assessment"})]})}),e.jsx("button",{onClick:O,disabled:y||!s.problemStatement,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:y?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"animate-spin -ml-0.5 mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Generating plan..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"-ml-0.5 mr-0 sm:mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"AI Troubleshooting Plan"})]})})]})]}),e.jsx("textarea",{ref:r,id:"problem",rows:8,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-3 border",placeholder:"Describe the problem...",defaultValue:s.problemStatement||"",onBlur:T})]}),f&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:f})})]})]})}),i&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden mt-4",children:[e.jsxs("div",{className:"bg-indigo-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-900 flex items-center",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-indigo-600"}),"AI Assessment Result"]}),e.jsx("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-gray-500",children:e.jsx(P,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Critique"}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 bg-gray-50 p-3 rounded-md text-sm whitespace-pre-wrap font-mono",children:i.critique})]}),i.improved_version&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 flex items-center",children:[e.jsx(W,{className:"h-4 w-4 mr-1 text-green-500"}),"Suggested Improvement"]}),e.jsx("div",{className:"bg-green-50 border border-green-100 p-3 rounded-md text-sm text-gray-800 font-medium whitespace-pre-wrap",children:i.improved_version}),e.jsx("button",{onClick:()=>{u({...s,problemStatement:i.improved_version}),r.current&&(r.current.value=i.improved_version)},className:"mt-2 text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"Apply this version"})]})]})]}),w&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(A,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:w})})]})]})}),N&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden mt-6",children:[e.jsxs("div",{className:"bg-blue-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-900 flex items-center",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-blue-600"}),"AI Troubleshooting Plan"]}),e.jsx("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-500",children:e.jsx(P,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 bg-gray-50 p-3 rounded-md text-sm whitespace-pre-wrap",children:N})})]})]})]})}):e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(p,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("p",{className:"mt-3 text-base font-medium text-gray-700",children:"Loading application data..."})]})})};export{G as default};
