import{c as E,V as O,Y as I,r as n,O as e,a3 as y,S as R,X as q,P as M}from"./index-DrdjLC35.js";import{A as V}from"./alert-circle-Q51Bgccg.js";/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=E("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),H=()=>{const{id:v}=O(),{a3Cases:N,updateA3Case:d}=I(),t=N.find(s=>s.id===v),r=n.useRef(null),[x,h]=n.useState(!1),[a,i]=n.useState(null),[p,u]=n.useState(null),[b,w]=n.useState(!1),[S,f]=n.useState("");n.useEffect(()=>{if(t&&r.current){const s=t.problemStatement||"";r.current.value!==s&&(r.current.value=s)}},[t==null?void 0:t.problemStatement]),n.useEffect(()=>{t&&f(t.problemContext||"")},[t==null?void 0:t.problemContext]);const k=async()=>{var s,o,g;if(t!=null&&t.problemStatement){h(!0),u(null),i(null);try{const c=(t.problemContext||"").trim(),P=[{role:"system",content:`You are an expert A3 Problem Solving coach.
          The user will provide a Problem Statement.
          
          Instructions:
          1. Assess if the problem statement is good using the 5W2H criteria (Who, What, Where, When, Which, How Often, How Much Impact).
          2. Provide a critique in English, even if the input is in another language.
          3. Offer an improved, clearer version of the problem statement in English.
          
          Requirements:
          - **Critique**: Be specific about what is missing or vague. Use Markdown.
          - **Improved Version**: Professional, concise, and includes all key aspects. No analysis or extra text, just the statement.
          - **Readability**: Break text into short paragraphs.
          
          RETURN JSON ONLY with keys:
          - "critique": string (markdown supported)
          - "improved_version": string
          `},{role:"user",content:`Problem Statement:
${t.problemStatement}`+(c?`

Additional Context:
${c}`:"")}],j=await fetch("https://multi-model-worker.study-llm.me/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"deepseek",messages:P,stream:!1})});if(!j.ok)throw new Error("Failed to fetch assessment");let l=((g=(o=(s=(await j.json()).choices)==null?void 0:s[0])==null?void 0:o.message)==null?void 0:g.content)||"{}";l=l.replace(/^```json\s*|\s*```$/g,"").replace(/^```\s*|\s*```$/g,"");try{const m=JSON.parse(l);i(m)}catch(m){console.error("JSON Parse Error",m),i({critique:l,improved_version:""})}}catch{u("Failed to assess problem statement. Please try again.")}finally{h(!1)}}},C=()=>{if(t&&r.current){const s=r.current.value;s!==t.problemStatement&&d({...t,problemStatement:s})}},A=s=>{if(!t)return;const o=s.target.value;f(o),d({...t,problemContext:o})};return t?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Problem Statement"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Clearly define the gap between the current state and the desired state."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("label",{htmlFor:"problem",className:"block text-sm font-medium text-gray-700",children:"What is the problem?"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>w(s=>!s),className:"inline-flex items-center px-3 py-1.5 border border-gray-200 text-xs font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:b?"Hide context":"Add context"}),e.jsx("button",{onClick:k,disabled:x||!t.problemStatement,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"animate-spin -ml-0.5 mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"Assessing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"-ml-0.5 mr-0 sm:mr-2 h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"AI Assessment"})]})})]})]}),e.jsx("textarea",{ref:r,id:"problem",rows:8,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-3 border",placeholder:"Describe the problem...",defaultValue:t.problemStatement||"",onBlur:C}),b&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{htmlFor:"problemContext",className:"block text-xs font-medium text-gray-700 mb-1",children:"Additional context (optional)"}),e.jsx("textarea",{id:"problemContext",rows:4,className:"w-full rounded-md border-gray-200 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-xs p-2 border",placeholder:"Add background, constraints, or any context that helps AI understand the problem.",value:S,onChange:A})]})]}),p&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(V,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:p})})]})]})}),a&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden mt-4",children:[e.jsxs("div",{className:"bg-indigo-50 px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-900 flex items-center",children:[e.jsx(R,{className:"h-4 w-4 mr-2 text-indigo-600"}),"AI Assessment Result"]}),e.jsx("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-500",children:e.jsx(q,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Critique"}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 bg-gray-50 p-3 rounded-md text-sm whitespace-pre-wrap font-mono",children:a.critique})]}),a.improved_version&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 flex items-center",children:[e.jsx(M,{className:"h-4 w-4 mr-1 text-green-500"}),"Suggested Improvement"]}),e.jsx("div",{className:"bg-green-50 border border-green-100 p-3 rounded-md text-sm text-gray-800 font-medium whitespace-pre-wrap",children:a.improved_version}),e.jsx("button",{onClick:()=>{d({...t,problemStatement:a.improved_version}),r.current&&(r.current.value=a.improved_version)},className:"mt-2 text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"Apply this version"})]})]})]})]})]})}):e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(y,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("p",{className:"mt-3 text-base font-medium text-gray-700",children:"Loading application data..."})]})})};export{H as default};
